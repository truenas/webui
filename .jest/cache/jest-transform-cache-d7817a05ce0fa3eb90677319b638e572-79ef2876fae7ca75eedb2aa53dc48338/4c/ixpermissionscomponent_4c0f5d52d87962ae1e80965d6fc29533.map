{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/forms/ix-forms/components/ix-permissions/ix-permissions.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/forms/ix-forms/components/ix-permissions/ix-permissions.component.ts"],"sourcesContent":["import {\n  ChangeDetectionStrategy, ChangeDetectorRef, Component, Input,\n} from '@angular/core';\nimport { ControlValueAccessor, NgControl } from '@angular/forms';\nimport { MatCheckbox } from '@angular/material/checkbox';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { PosixPermission } from 'app/enums/posix-acl.enum';\nimport { parseMode } from 'app/helpers/mode.helper';\nimport { IxErrorsComponent } from 'app/modules/forms/ix-forms/components/ix-errors/ix-errors.component';\nimport { IxLabelComponent } from 'app/modules/forms/ix-forms/components/ix-label/ix-label.component';\nimport { TestOverrideDirective } from 'app/modules/test-id/test-override/test-override.directive';\nimport { TestDirective } from 'app/modules/test-id/test.directive';\n\n@Component({\n  selector: 'ix-permissions',\n  templateUrl: './ix-permissions.component.html',\n  styleUrls: ['./ix-permissions.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    IxLabelComponent,\n    MatCheckbox,\n    IxErrorsComponent,\n    TranslateModule,\n    TestOverrideDirective,\n    TestDirective,\n  ],\n})\nexport class IxPermissionsComponent implements ControlValueAccessor {\n  @Input() label: string;\n  @Input() tooltip: string;\n  @Input() required: boolean;\n  @Input() hideOthersPermissions = false;\n\n  isDisabled = false;\n\n  value: string;\n\n  ownerRead = false;\n  ownerWrite = false;\n  ownerExec = false;\n  groupRead = false;\n  groupWrite = false;\n  groupExec = false;\n  otherRead = false;\n  otherWrite = false;\n  otherExec = false;\n\n  private owner = 0;\n  private grp = 0;\n  private other = 0;\n\n  private formatRe = /^[0-7][0-7][0-7]$/;\n\n  constructor(\n    public controlDirective: NgControl,\n    private cdr: ChangeDetectorRef,\n  ) {\n    this.controlDirective.valueAccessor = this;\n  }\n\n  writeValue(value: string): void {\n    this.setPermissionsAndUpdateValue(value);\n  }\n\n  setPermissionsAndUpdateValue(value = '000'): void {\n    if (value && this.formatRe.test(value)) {\n      this.value = value;\n    } else {\n      this.value = '000';\n      console.error('Invalid value format for ', this.label);\n    }\n\n    this.owner = parseInt(this.value[0]);\n    this.grp = parseInt(this.value[1]);\n    this.other = parseInt(this.value[2]);\n\n    const permissions = parseMode(this.value);\n\n    this.ownerRead = permissions.owner[PosixPermission.Read];\n    this.ownerWrite = permissions.owner[PosixPermission.Write];\n    this.ownerExec = permissions.owner[PosixPermission.Execute];\n\n    this.groupRead = permissions.group[PosixPermission.Read];\n    this.groupWrite = permissions.group[PosixPermission.Write];\n    this.groupExec = permissions.group[PosixPermission.Execute];\n\n    this.otherRead = permissions.other[PosixPermission.Read];\n    this.otherWrite = permissions.other[PosixPermission.Write];\n    this.otherExec = permissions.other[PosixPermission.Execute];\n  }\n\n  onChange?: (value: string) => void = (): void => {};\n\n  onTouched?: () => void = (): void => {};\n\n  registerOnChange(onChange: (value: string | number) => void): void {\n    this.onChange = onChange;\n  }\n\n  registerOnTouched(onTouched: () => void): void {\n    this.onTouched = onTouched;\n  }\n\n  setDisabledState?(isDisabled: boolean): void {\n    this.isDisabled = isDisabled;\n    this.cdr.markForCheck();\n  }\n\n  toggleOwnerRead(): void {\n    if (this.ownerRead) {\n      this.ownerRead = false;\n      this.owner -= 4;\n    } else {\n      this.ownerRead = true;\n      this.owner += 4;\n    }\n    this.updateValue();\n  }\n\n  toggleOwnerWrite(): void {\n    if (this.ownerWrite) {\n      this.ownerWrite = false;\n      this.owner -= 2;\n    } else {\n      this.ownerWrite = true;\n      this.owner += 2;\n    }\n    this.updateValue();\n  }\n\n  toggleOwnerExec(): void {\n    if (this.ownerExec) {\n      this.ownerExec = false;\n      this.owner -= 1;\n    } else {\n      this.ownerExec = true;\n      this.owner += 1;\n    }\n    this.updateValue();\n  }\n\n  toggleGroupRead(): void {\n    if (this.groupRead) {\n      this.groupRead = false;\n      this.grp -= 4;\n    } else {\n      this.groupRead = true;\n      this.grp += 4;\n    }\n    this.updateValue();\n  }\n\n  toggleGroupWrite(): void {\n    if (this.groupWrite) {\n      this.groupWrite = false;\n      this.grp -= 2;\n    } else {\n      this.groupWrite = true;\n      this.grp += 2;\n    }\n    this.updateValue();\n  }\n\n  toggleGroupExec(): void {\n    if (this.groupExec) {\n      this.groupExec = false;\n      this.grp -= 1;\n    } else {\n      this.groupExec = true;\n      this.grp += 1;\n    }\n    this.updateValue();\n  }\n\n  toggleOtherRead(): void {\n    if (this.otherRead) {\n      this.otherRead = false;\n      this.other -= 4;\n    } else {\n      this.otherRead = true;\n      this.other += 4;\n    }\n    this.updateValue();\n  }\n\n  toggleOtherWrite(): void {\n    if (this.otherWrite) {\n      this.otherWrite = false;\n      this.other -= 2;\n    } else {\n      this.otherWrite = true;\n      this.other += 2;\n    }\n    this.updateValue();\n  }\n\n  toggleOtherExec(): void {\n    if (this.otherExec) {\n      this.otherExec = false;\n      this.other -= 1;\n    } else {\n      this.otherExec = true;\n      this.other += 1;\n    }\n    this.updateValue();\n  }\n\n  updateValue(): void {\n    this.value = this.owner.toString() + this.grp.toString() + this.other.toString();\n    this.onChange(this.value);\n  }\n}\n"],"version":3}