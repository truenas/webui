{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/datasets/modules/permissions/components/view-nfs-permissions/view-nfs-permissions.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/datasets/modules/permissions/components/view-nfs-permissions/view-nfs-permissions.component.ts"],"sourcesContent":["import { CdkAccordion, CdkAccordionItem } from '@angular/cdk/accordion';\nimport {\n  ChangeDetectionStrategy, Component, Input, OnChanges,\n} from '@angular/core';\nimport { TranslateService, TranslateModule } from '@ngx-translate/core';\nimport {\n  NfsAdvancedFlag, nfsAdvancedFlagLabels,\n  NfsAdvancedPermission, nfsAdvancedPermissionLabels, nfsBasicFlagLabels, nfsBasicPermissionLabels,\n} from 'app/enums/nfs-acl.enum';\nimport {\n  areNfsFlagsBasic,\n  areNfsPermissionsBasic,\n  NfsAcl, NfsAclItem,\n} from 'app/interfaces/acl.interface';\nimport { IxIconComponent } from 'app/modules/ix-icon/ix-icon.component';\nimport { PermissionsItemComponent } from 'app/pages/datasets/modules/permissions/components/permissions-item/permissions-item.component';\nimport { PermissionItem } from 'app/pages/datasets/modules/permissions/interfaces/permission-item.interface';\nimport { nfsAceToPermissionItem } from 'app/pages/datasets/modules/permissions/utils/nfs-ace-to-permission-item.utils';\n\ninterface PermissionDetails {\n  arePermissionsBasic: boolean;\n  permissions: string[];\n\n  areFlagsBasic: boolean;\n  flags: string[];\n}\n\n@Component({\n  selector: 'ix-view-nfs-permissions',\n  templateUrl: 'view-nfs-permissions.component.html',\n  styleUrls: ['./view-nfs-permissions.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    CdkAccordion,\n    CdkAccordionItem,\n    PermissionsItemComponent,\n    IxIconComponent,\n    TranslateModule,\n  ],\n})\nexport class ViewNfsPermissionsComponent implements OnChanges {\n  @Input() acl: NfsAcl;\n\n  permissionItems: PermissionItem[] = [];\n  permissionDetails: PermissionDetails[] = [];\n\n  constructor(\n    private translate: TranslateService,\n  ) {}\n\n  ngOnChanges(): void {\n    this.transformAcl();\n  }\n\n  private transformAcl(): void {\n    this.permissionItems = [];\n    this.permissionDetails = [];\n\n    this.acl.acl.forEach((ace) => {\n      this.permissionItems.push(nfsAceToPermissionItem(this.translate, ace));\n      this.permissionDetails.push(this.aceToPermissionDetails(ace));\n    });\n  }\n\n  private aceToPermissionDetails(ace: NfsAclItem): PermissionDetails {\n    // Permissions\n    let arePermissionsBasic: boolean;\n    let permissions: string[];\n\n    if (areNfsPermissionsBasic(ace.perms)) {\n      arePermissionsBasic = true;\n      permissions = [this.translate.instant(nfsBasicPermissionLabels.get(ace.perms.BASIC))];\n    } else {\n      arePermissionsBasic = false;\n      permissions = Object.entries(ace.perms)\n        .filter(([, isOn]) => isOn)\n        .map(([permission]) => {\n          return this.translate.instant(nfsAdvancedPermissionLabels.get(permission as NfsAdvancedPermission));\n        });\n    }\n\n    // Flags\n    let areFlagsBasic: boolean;\n    let flags: string[];\n\n    if (areNfsFlagsBasic(ace.flags)) {\n      areFlagsBasic = true;\n      flags = [this.translate.instant(nfsBasicFlagLabels.get(ace.flags.BASIC))];\n    } else {\n      areFlagsBasic = false;\n      flags = Object.entries(ace.flags)\n        .filter(([, isOn]) => isOn)\n        .map(([flag]) => {\n          return this.translate.instant(nfsAdvancedFlagLabels.get(flag as NfsAdvancedFlag));\n        });\n    }\n\n    return {\n      flags,\n      permissions,\n      areFlagsBasic,\n      arePermissionsBasic,\n    };\n  }\n}\n"],"version":3}