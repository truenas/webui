c62e91cbc72cee4575d423d54bd3d0d6
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GroupComboboxProvider = void 0;
const operators_1 = require("rxjs/operators");
class GroupComboboxProvider {
    fetch(filterValue) {
        this.page = 0;
        const offset = this.page * this.pageSize;
        return this.userService.groupQueryDsCache(filterValue, false, offset)
            .pipe((0, operators_1.map)((groups) => this.groupQueryResToOptions(groups)), (0, operators_1.map)((options) => [...this.initialOptions, ...this.excludeInitialOptions(options)]));
    }
    excludeInitialOptions(options) {
        return options.filter((option) => {
            return !this.initialOptions.find((initialOption) => initialOption.value === option.value);
        });
    }
    groupQueryResToOptions(groups) {
        return groups.map((group) => {
            return { label: group.group, value: group[this.optionsValueField] };
        });
    }
    nextPage(filterValue) {
        this.page++;
        const offset = this.page * this.pageSize;
        return this.userService.groupQueryDsCache(filterValue, false, offset)
            .pipe((0, operators_1.map)((groups) => this.groupQueryResToOptions(groups)), (0, operators_1.map)((groups) => this.excludeInitialOptions(groups)));
    }
    constructor(userService, optionsValueField = 'group', initialOptions = []) {
        this.userService = userService;
        this.optionsValueField = optionsValueField;
        this.initialOptions = initialOptions;
        this.page = 1;
        this.pageSize = 50;
    }
}
exports.GroupComboboxProvider = GroupComboboxProvider;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hY2Jvb2sva2FycG92LXdvcmsvVHJ1ZU5BUy93ZWJ1aS9zcmMvYXBwL21vZHVsZXMvZm9ybXMvaXgtZm9ybXMvY2xhc3Nlcy9ncm91cC1jb21ib2JveC1wcm92aWRlci50cyIsIm1hcHBpbmdzIjoiOzs7QUFDQSw4Q0FBcUM7QUFNckMsTUFBYSxxQkFBcUI7SUFJaEMsS0FBSyxDQUFDLFdBQW1CO1FBQ3ZCLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBRXpDLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQzthQUNsRSxJQUFJLENBQ0gsSUFBQSxlQUFHLEVBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUNwRCxJQUFBLGVBQUcsRUFBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxjQUFjLEVBQUUsR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUNuRixDQUFDO0lBQ04sQ0FBQztJQUVELHFCQUFxQixDQUFDLE9BQWlCO1FBQ3JDLE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFO1lBQy9CLE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUMsYUFBYSxDQUFDLEtBQUssS0FBSyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUYsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsc0JBQXNCLENBQUMsTUFBZTtRQUNwQyxPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUMxQixPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDO1FBQ3RFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELFFBQVEsQ0FBQyxXQUFtQjtRQUMxQixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDWixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDekMsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDO2FBQ2xFLElBQUksQ0FDSCxJQUFBLGVBQUcsRUFBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQ3BELElBQUEsZUFBRyxFQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FDcEQsQ0FBQztJQUNOLENBQUM7SUFFRCxZQUNZLFdBQXdCLEVBQzFCLG9CQUE0QyxPQUFPLEVBQ2pELGlCQUEyQixFQUFFO1FBRjdCLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQzFCLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBa0M7UUFDakQsbUJBQWMsR0FBZCxjQUFjLENBQWU7UUF2Qy9CLFNBQUksR0FBRyxDQUFDLENBQUM7UUFDVixhQUFRLEdBQUcsRUFBRSxDQUFDO0lBdUNwQixDQUFDO0NBQ0w7QUExQ0Qsc0RBMENDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYWNib29rL2thcnBvdi13b3JrL1RydWVOQVMvd2VidWkvc3JjL2FwcC9tb2R1bGVzL2Zvcm1zL2l4LWZvcm1zL2NsYXNzZXMvZ3JvdXAtY29tYm9ib3gtcHJvdmlkZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgR3JvdXAgfSBmcm9tICdhcHAvaW50ZXJmYWNlcy9ncm91cC5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSAnYXBwL2ludGVyZmFjZXMvb3B0aW9uLmludGVyZmFjZSc7XG5pbXBvcnQgeyBJeENvbWJvYm94UHJvdmlkZXIgfSBmcm9tICdhcHAvbW9kdWxlcy9mb3Jtcy9peC1mb3Jtcy9jb21wb25lbnRzL2l4LWNvbWJvYm94L2l4LWNvbWJvYm94LXByb3ZpZGVyJztcbmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnYXBwL3NlcnZpY2VzL3VzZXIuc2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBHcm91cENvbWJvYm94UHJvdmlkZXIgaW1wbGVtZW50cyBJeENvbWJvYm94UHJvdmlkZXIge1xuICBwcm90ZWN0ZWQgcGFnZSA9IDE7XG4gIHJlYWRvbmx5IHBhZ2VTaXplID0gNTA7XG5cbiAgZmV0Y2goZmlsdGVyVmFsdWU6IHN0cmluZyk6IE9ic2VydmFibGU8T3B0aW9uW10+IHtcbiAgICB0aGlzLnBhZ2UgPSAwO1xuICAgIGNvbnN0IG9mZnNldCA9IHRoaXMucGFnZSAqIHRoaXMucGFnZVNpemU7XG5cbiAgICByZXR1cm4gdGhpcy51c2VyU2VydmljZS5ncm91cFF1ZXJ5RHNDYWNoZShmaWx0ZXJWYWx1ZSwgZmFsc2UsIG9mZnNldClcbiAgICAgIC5waXBlKFxuICAgICAgICBtYXAoKGdyb3VwcykgPT4gdGhpcy5ncm91cFF1ZXJ5UmVzVG9PcHRpb25zKGdyb3VwcykpLFxuICAgICAgICBtYXAoKG9wdGlvbnMpID0+IFsuLi50aGlzLmluaXRpYWxPcHRpb25zLCAuLi50aGlzLmV4Y2x1ZGVJbml0aWFsT3B0aW9ucyhvcHRpb25zKV0pLFxuICAgICAgKTtcbiAgfVxuXG4gIGV4Y2x1ZGVJbml0aWFsT3B0aW9ucyhvcHRpb25zOiBPcHRpb25bXSk6IE9wdGlvbltdIHtcbiAgICByZXR1cm4gb3B0aW9ucy5maWx0ZXIoKG9wdGlvbikgPT4ge1xuICAgICAgcmV0dXJuICF0aGlzLmluaXRpYWxPcHRpb25zLmZpbmQoKGluaXRpYWxPcHRpb24pID0+IGluaXRpYWxPcHRpb24udmFsdWUgPT09IG9wdGlvbi52YWx1ZSk7XG4gICAgfSk7XG4gIH1cblxuICBncm91cFF1ZXJ5UmVzVG9PcHRpb25zKGdyb3VwczogR3JvdXBbXSk6IE9wdGlvbltdIHtcbiAgICByZXR1cm4gZ3JvdXBzLm1hcCgoZ3JvdXApID0+IHtcbiAgICAgIHJldHVybiB7IGxhYmVsOiBncm91cC5ncm91cCwgdmFsdWU6IGdyb3VwW3RoaXMub3B0aW9uc1ZhbHVlRmllbGRdIH07XG4gICAgfSk7XG4gIH1cblxuICBuZXh0UGFnZShmaWx0ZXJWYWx1ZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxPcHRpb25bXT4ge1xuICAgIHRoaXMucGFnZSsrO1xuICAgIGNvbnN0IG9mZnNldCA9IHRoaXMucGFnZSAqIHRoaXMucGFnZVNpemU7XG4gICAgcmV0dXJuIHRoaXMudXNlclNlcnZpY2UuZ3JvdXBRdWVyeURzQ2FjaGUoZmlsdGVyVmFsdWUsIGZhbHNlLCBvZmZzZXQpXG4gICAgICAucGlwZShcbiAgICAgICAgbWFwKChncm91cHMpID0+IHRoaXMuZ3JvdXBRdWVyeVJlc1RvT3B0aW9ucyhncm91cHMpKSxcbiAgICAgICAgbWFwKChncm91cHMpID0+IHRoaXMuZXhjbHVkZUluaXRpYWxPcHRpb25zKGdyb3VwcykpLFxuICAgICAgKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCB1c2VyU2VydmljZTogVXNlclNlcnZpY2UsXG4gICAgcHJpdmF0ZSBvcHRpb25zVmFsdWVGaWVsZDogJ2dyb3VwJyB8ICdnaWQnIHwgJ2lkJyA9ICdncm91cCcsXG4gICAgcHJvdGVjdGVkIGluaXRpYWxPcHRpb25zOiBPcHRpb25bXSA9IFtdLFxuICApIHt9XG59XG4iXSwidmVyc2lvbiI6M30=