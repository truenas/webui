{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/feedback/components/file-review/file-review.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/feedback/components/file-review/file-review.component.ts"],"sourcesContent":["import { CdkScrollable } from '@angular/cdk/scrolling';\nimport { AsyncPipe } from '@angular/common';\nimport {\n  ChangeDetectionStrategy, Component, Input, output,\n} from '@angular/core';\nimport { FormBuilder, Validators, ReactiveFormsModule } from '@angular/forms';\nimport { MatButton } from '@angular/material/button';\nimport { MatDialogRef, MatDialogContent, MatDialogActions } from '@angular/material/dialog';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { finalize } from 'rxjs';\nimport { MiB } from 'app/constants/bytes.constant';\nimport { ticketAcceptedFiles } from 'app/enums/file-ticket.enum';\nimport { helptextSystemSupport as helptext } from 'app/helptext/system/support';\nimport { FeedbackDialogComponent } from 'app/modules/feedback/components/feedback-dialog/feedback-dialog.component';\nimport { FeedbackService } from 'app/modules/feedback/services/feedback.service';\nimport { FormActionsComponent } from 'app/modules/forms/ix-forms/components/form-actions/form-actions.component';\nimport { IxCheckboxComponent } from 'app/modules/forms/ix-forms/components/ix-checkbox/ix-checkbox.component';\nimport { IxFileInputComponent } from 'app/modules/forms/ix-forms/components/ix-file-input/ix-file-input.component';\nimport { IxStarRatingComponent } from 'app/modules/forms/ix-forms/components/ix-star-rating/ix-star-rating.component';\nimport { IxTextareaComponent } from 'app/modules/forms/ix-forms/components/ix-textarea/ix-textarea.component';\nimport { ImageValidatorService } from 'app/modules/forms/ix-forms/validators/image-validator/image-validator.service';\nimport { rangeValidator } from 'app/modules/forms/ix-forms/validators/range-validation/range-validation';\nimport { TestDirective } from 'app/modules/test-id/test.directive';\nimport { ErrorHandlerService } from 'app/services/error-handler.service';\nimport { SystemGeneralService } from 'app/services/system-general.service';\n\nexport const maxRatingValue = 5;\nexport const maxFileSizeBytes = 5 * MiB;\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-file-review',\n  styleUrls: ['file-review.component.scss'],\n  templateUrl: './file-review.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    CdkScrollable,\n    MatDialogContent,\n    ReactiveFormsModule,\n    IxStarRatingComponent,\n    IxTextareaComponent,\n    IxCheckboxComponent,\n    IxFileInputComponent,\n    MatDialogActions,\n    FormActionsComponent,\n    MatButton,\n    TestDirective,\n    TranslateModule,\n    AsyncPipe,\n  ],\n})\nexport class FileReviewComponent {\n  @Input() dialogRef: MatDialogRef<FeedbackDialogComponent>;\n  @Input() isLoading: boolean;\n\n  readonly isLoadingChange = output<boolean>();\n\n  protected isEnterprise$ = this.systemGeneralService.isEnterprise$;\n\n  protected form = this.formBuilder.group({\n    rating: [undefined as number, [Validators.required, rangeValidator(1, maxRatingValue)]],\n    message: ['', [Validators.maxLength(4067)]],\n\n    images: [[] as File[], [], this.imageValidator.getImagesValidator(maxFileSizeBytes)],\n    attach_images: [false],\n    take_screenshot: [true],\n  });\n\n  protected readonly messagePlaceholder = helptext.review.message.placeholder;\n  protected readonly voteForNewFeaturesText = helptext.review.vote_for_new_features;\n  protected readonly acceptedFiles = ticketAcceptedFiles;\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private errorHandler: ErrorHandlerService,\n    private imageValidator: ImageValidatorService,\n    private feedbackService: FeedbackService,\n    private systemGeneralService: SystemGeneralService,\n  ) {}\n\n  onSubmit(): void {\n    this.isLoadingChange.emit(true);\n\n    this.feedbackService.createReview(this.form.value).pipe(\n      this.errorHandler.catchError(),\n      finalize(() => this.isLoadingChange.emit(false)),\n      untilDestroyed(this),\n    ).subscribe(() => this.onSuccess());\n  }\n\n  private onSuccess(): void {\n    this.feedbackService.showFeedbackSuccessMsg();\n    this.dialogRef.close();\n  }\n}\n"],"version":3}