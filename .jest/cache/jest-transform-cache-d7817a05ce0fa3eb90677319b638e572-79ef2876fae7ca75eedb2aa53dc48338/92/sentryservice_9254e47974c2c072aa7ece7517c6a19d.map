{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/services/sentry.service.ts","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wCAA2C;AAC3C,uCAAoC;AACpC,wDAA0C;AAC1C,iDAAqC;AACrC,0DAAuD;AACvD,+BAAsD;AAEtD,uFAAgF;AAKzE,IAAM,aAAa,GAAnB,MAAM,aAAa;IAGxB,YACU,MAAuB;QAAvB,WAAM,GAAN,MAAM,CAAiB;QAHjC,eAAU,GAAG,IAAI,sBAAe,CAAS,oBAAI,CAAC,IAAI,EAAE,CAAC,CAAC;IAInD,CAAC;IAEJ,IAAI;QACF,IAAI,CAAC,yBAAW,CAAC,UAAU,EAAE,CAAC;YAC5B,OAAO;QACT,CAAC;QAED,IAAA,oBAAa,EAAC;YACZ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,yCAAiB,CAAC;YACnC,IAAI,CAAC,UAAU;SAChB,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE,EAAE;YACpC,MAAM,CAAC,IAAI,CAAC;gBACV,GAAG,EAAE,yBAAW,CAAC,eAAe;gBAChC,OAAO,EAAE,OAAO,CAAC,OAAO;aACzB,CAAC,CAAC;YACH,MAAM,CAAC,cAAc,CAAC,CAAC,KAAK,EAAE,EAAE;gBAC9B,KAAK,CAAC,MAAM,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;YACxC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;;AAxBU,sCAAa;;;;wBAAb,aAAa;IAHzB,IAAA,iBAAU,EAAC;QACV,UAAU,EAAE,MAAM;KACnB,CAAC;GACW,aAAa,CAyBzB","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/services/sentry.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Store } from '@ngrx/store';\nimport * as Sentry from '@sentry/angular';\nimport { UUID } from 'angular2-uuid';\nimport { environment } from 'environments/environment';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { AppState } from 'app/store';\nimport { waitForSystemInfo } from 'app/store/system-info/system-info.selectors';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SentryService {\n  sessionId$ = new BehaviorSubject<string>(UUID.UUID());\n\n  constructor(\n    private store$: Store<AppState>,\n  ) {}\n\n  init(): void {\n    if (!environment.production) {\n      return;\n    }\n\n    combineLatest([\n      this.store$.pipe(waitForSystemInfo),\n      this.sessionId$,\n    ]).subscribe(([sysInfo, sessionId]) => {\n      Sentry.init({\n        dsn: environment.sentryPublicDsn,\n        release: sysInfo.version,\n      });\n      Sentry.configureScope((scope) => {\n        scope.setTag('session_id', sessionId);\n      });\n    });\n  }\n}\n"],"version":3}