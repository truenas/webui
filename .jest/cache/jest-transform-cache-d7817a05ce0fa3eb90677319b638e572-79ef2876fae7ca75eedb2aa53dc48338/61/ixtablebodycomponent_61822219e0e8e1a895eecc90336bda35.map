{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/ix-table/components/ix-table-body/ix-table-body.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/ix-table/components/ix-table-body/ix-table-body.component.ts"],"sourcesContent":["import {\n  NgStyle, NgClass, NgTemplateOutlet, AsyncPipe,\n} from '@angular/common';\nimport {\n  AfterViewInit,\n  ChangeDetectorRef,\n  ChangeDetectionStrategy,\n  Component,\n  ContentChild,\n  ContentChildren,\n  Input,\n  QueryList,\n  TemplateRef, output,\n} from '@angular/core';\nimport { MatIconButton } from '@angular/material/button';\nimport { MatProgressSpinner } from '@angular/material/progress-spinner';\nimport { MatTooltip } from '@angular/material/tooltip';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { UiSearchDirective } from 'app/directives/ui-search.directive';\nimport { IxIconComponent } from 'app/modules/ix-icon/ix-icon.component';\nimport { IxTableBodyCellDirective } from 'app/modules/ix-table/directives/ix-body-cell.directive';\nimport { IxTableCellDirective } from 'app/modules/ix-table/directives/ix-table-cell.directive';\nimport { IxTableDetailsRowDirective } from 'app/modules/ix-table/directives/ix-table-details-row.directive';\nimport { Column, ColumnComponent } from 'app/modules/ix-table/interfaces/column-component.class';\nimport { DataProvider } from 'app/modules/ix-table/interfaces/data-provider.interface';\nimport { TestDirective } from 'app/modules/test-id/test.directive';\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-table-body, tbody[ix-table-body]',\n  templateUrl: './ix-table-body.component.html',\n  styleUrls: ['ix-table-body.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    UiSearchDirective,\n    NgStyle,\n    NgClass,\n    NgTemplateOutlet,\n    IxTableBodyCellDirective,\n    MatIconButton,\n    MatTooltip,\n    IxIconComponent,\n    MatProgressSpinner,\n    TranslateModule,\n    AsyncPipe,\n    TestDirective,\n  ],\n})\nexport class IxTableBodyComponent<T> implements AfterViewInit {\n  @Input() columns: Column<T, ColumnComponent<T>>[];\n  @Input() dataProvider: DataProvider<T>;\n  @Input() isLoading = false;\n  @Input() detailsRowIdentifier: keyof T = 'id' as keyof T;\n\n  readonly expanded = output<T>();\n\n  @ContentChildren(IxTableCellDirective) customCells!: QueryList<IxTableCellDirective<T>>;\n\n  @ContentChild(IxTableDetailsRowDirective) detailsRow: IxTableDetailsRowDirective<T>;\n\n  get displayedColumns(): Column<T, ColumnComponent<T>>[] {\n    return this.columns?.filter((column) => !column?.hidden);\n  }\n\n  get detailsTemplate(): TemplateRef<{ $implicit: T }> | undefined {\n    return this.detailsRow?.templateRef;\n  }\n\n  constructor(private cdr: ChangeDetectorRef) {}\n\n  ngAfterViewInit(): void {\n    const templatedCellIndexes = this.customCells.toArray().map((cell) => cell.columnIndex);\n    const availableIndexes = Array.from({ length: this.columns.length }, (_, idx) => idx)\n      .filter((idx) => !templatedCellIndexes.includes(idx));\n\n    this.customCells.forEach((cell) => {\n      if (cell.columnIndex === undefined) {\n        cell.columnIndex = availableIndexes.shift();\n      }\n    });\n\n    this.dataProvider.currentPage$.pipe(untilDestroyed(this)).subscribe(() => {\n      this.cdr.detectChanges();\n      this.cdr.markForCheck();\n    });\n  }\n\n  getRowTag(row: T): string {\n    return this.columns[0]?.uniqueRowTag(row) ?? '';\n  }\n\n  getTemplateByColumnIndex(idx: number): TemplateRef<{ $implicit: T }> | undefined {\n    return this.customCells.toArray().find((cell) => cell.columnIndex === idx)?.templateRef;\n  }\n\n  onToggle(row: T): void {\n    this.dataProvider.expandedRow = this.isExpanded(row) ? null : row;\n    this.expanded.emit(this.dataProvider.expandedRow);\n  }\n\n  isExpanded(row: T): boolean {\n    return this.detailsRowIdentifier\n      && (this.dataProvider?.expandedRow?.[this.detailsRowIdentifier] === row?.[this.detailsRowIdentifier]);\n  }\n\n  protected trackRowByIdentity(item: T): string {\n    return this.getRowTag(item);\n  }\n\n  protected trackColumnByIdentity(column: Column<T, ColumnComponent<T>>): Column<T, ColumnComponent<T>> {\n    return column;\n  }\n}\n"],"version":3}