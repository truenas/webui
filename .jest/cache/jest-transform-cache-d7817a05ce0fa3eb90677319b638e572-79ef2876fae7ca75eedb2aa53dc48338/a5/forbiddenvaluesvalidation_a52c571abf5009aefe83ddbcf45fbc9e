527f6c534ec6fcc0db725a29cd095e9f
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.forbiddenValues = forbiddenValues;
exports.forbiddenAsyncValues = forbiddenAsyncValues;
exports.forbiddenValuesError = forbiddenValuesError;
const rxjs_1 = require("rxjs");
const operators_1 = require("rxjs/operators");
function forbiddenValues(arrayOfValues, caseInsensitive) {
    return (control) => {
        if (control.value === '' || control.value === undefined) {
            return null;
        }
        return forbiddenValuesError(arrayOfValues, caseInsensitive, control);
    };
}
function forbiddenAsyncValues(arrayOfValues$, caseInsensitive) {
    const request$ = arrayOfValues$.pipe((0, rxjs_1.shareReplay)({ refCount: false, bufferSize: 1 }), (0, operators_1.catchError)((error) => {
        console.error(error);
        return (0, rxjs_1.of)(null);
    }));
    return (control) => {
        if (control.value === '' || control.value === undefined) {
            return (0, rxjs_1.of)(null);
        }
        return request$.pipe((0, rxjs_1.map)((arrayOfValues) => {
            return forbiddenValuesError(arrayOfValues, caseInsensitive, control);
        }));
    };
}
function forbiddenValuesError(values, caseInsensitive, formControl) {
    if (caseInsensitive) {
        const existingValue = values.find((val) => val.toLowerCase().trim() === formControl.value.toLowerCase().trim());
        return existingValue ? { forbidden: true, value: existingValue } : null;
    }
    if (values.includes(formControl.value)) {
        return { forbidden: true, value: formControl.value };
    }
    return null;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hY2Jvb2sva2FycG92LXdvcmsvVHJ1ZU5BUy93ZWJ1aS9zcmMvYXBwL21vZHVsZXMvZm9ybXMvaXgtZm9ybXMvdmFsaWRhdG9ycy9mb3JiaWRkZW4tdmFsdWVzLXZhbGlkYXRpb24vZm9yYmlkZGVuLXZhbHVlcy12YWxpZGF0aW9uLnRzIiwibWFwcGluZ3MiOiI7O0FBUUEsMENBUUM7QUFFRCxvREF1QkM7QUFFRCxvREFjQztBQXRERCwrQkFFYztBQUNkLDhDQUE0QztBQUU1QyxTQUFnQixlQUFlLENBQUMsYUFBdUIsRUFBRSxlQUF5QjtJQUNoRixPQUFPLENBQUMsT0FBNEIsRUFBMkIsRUFBRTtRQUMvRCxJQUFJLE9BQU8sQ0FBQyxLQUFLLEtBQUssRUFBRSxJQUFJLE9BQU8sQ0FBQyxLQUFLLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDeEQsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBRUQsT0FBTyxvQkFBb0IsQ0FBQyxhQUFhLEVBQUUsZUFBZSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3ZFLENBQUMsQ0FBQztBQUNKLENBQUM7QUFFRCxTQUFnQixvQkFBb0IsQ0FDbEMsY0FBb0MsRUFDcEMsZUFBeUI7SUFFekIsTUFBTSxRQUFRLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FDbEMsSUFBQSxrQkFBVyxFQUFDLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFDL0MsSUFBQSxzQkFBVSxFQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDbkIsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNyQixPQUFPLElBQUEsU0FBRSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xCLENBQUMsQ0FBQyxDQUNILENBQUM7SUFFRixPQUFPLENBQUMsT0FBNEIsRUFBdUMsRUFBRTtRQUMzRSxJQUFJLE9BQU8sQ0FBQyxLQUFLLEtBQUssRUFBRSxJQUFJLE9BQU8sQ0FBQyxLQUFLLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDeEQsT0FBTyxJQUFBLFNBQUUsRUFBQyxJQUFJLENBQUMsQ0FBQztRQUNsQixDQUFDO1FBRUQsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUNsQixJQUFBLFVBQUcsRUFBQyxDQUFDLGFBQWEsRUFBRSxFQUFFO1lBQ3BCLE9BQU8sb0JBQW9CLENBQUMsYUFBYSxFQUFFLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FDSCxDQUFDO0lBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELFNBQWdCLG9CQUFvQixDQUNsQyxNQUFnQixFQUNoQixlQUF3QixFQUN4QixXQUFnQztJQUVoQyxJQUFJLGVBQWUsRUFBRSxDQUFDO1FBQ3BCLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxXQUFXLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDaEgsT0FBTyxhQUFhLENBQUMsQ0FBQyxDQUFDLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUMxRSxDQUFDO0lBQ0QsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQ3ZDLE9BQU8sRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDdkQsQ0FBQztJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvbWFjYm9vay9rYXJwb3Ytd29yay9UcnVlTkFTL3dlYnVpL3NyYy9hcHAvbW9kdWxlcy9mb3Jtcy9peC1mb3Jtcy92YWxpZGF0b3JzL2ZvcmJpZGRlbi12YWx1ZXMtdmFsaWRhdGlvbi9mb3JiaWRkZW4tdmFsdWVzLXZhbGlkYXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQXN5bmNWYWxpZGF0b3JGbiwgRm9ybUNvbnRyb2wsIFZhbGlkYXRpb25FcnJvcnMsIFZhbGlkYXRvckZuLFxufSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge1xuICBtYXAsIE9ic2VydmFibGUsIG9mLCBzaGFyZVJlcGxheSxcbn0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBjYXRjaEVycm9yIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5leHBvcnQgZnVuY3Rpb24gZm9yYmlkZGVuVmFsdWVzKGFycmF5T2ZWYWx1ZXM6IHN0cmluZ1tdLCBjYXNlSW5zZW5zaXRpdmU/OiBib29sZWFuKTogVmFsaWRhdG9yRm4ge1xuICByZXR1cm4gKGNvbnRyb2w6IEZvcm1Db250cm9sPHN0cmluZz4pOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCA9PiB7XG4gICAgaWYgKGNvbnRyb2wudmFsdWUgPT09ICcnIHx8IGNvbnRyb2wudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvcmJpZGRlblZhbHVlc0Vycm9yKGFycmF5T2ZWYWx1ZXMsIGNhc2VJbnNlbnNpdGl2ZSwgY29udHJvbCk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JiaWRkZW5Bc3luY1ZhbHVlcyhcbiAgYXJyYXlPZlZhbHVlcyQ6IE9ic2VydmFibGU8c3RyaW5nW10+LFxuICBjYXNlSW5zZW5zaXRpdmU/OiBib29sZWFuLFxuKTogQXN5bmNWYWxpZGF0b3JGbiB7XG4gIGNvbnN0IHJlcXVlc3QkID0gYXJyYXlPZlZhbHVlcyQucGlwZShcbiAgICBzaGFyZVJlcGxheSh7IHJlZkNvdW50OiBmYWxzZSwgYnVmZmVyU2l6ZTogMSB9KSxcbiAgICBjYXRjaEVycm9yKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICByZXR1cm4gb2YobnVsbCk7XG4gICAgfSksXG4gICk7XG5cbiAgcmV0dXJuIChjb250cm9sOiBGb3JtQ29udHJvbDxzdHJpbmc+KTogT2JzZXJ2YWJsZTxWYWxpZGF0aW9uRXJyb3JzPiB8IG51bGwgPT4ge1xuICAgIGlmIChjb250cm9sLnZhbHVlID09PSAnJyB8fCBjb250cm9sLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBvZihudWxsKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVxdWVzdCQucGlwZShcbiAgICAgIG1hcCgoYXJyYXlPZlZhbHVlcykgPT4ge1xuICAgICAgICByZXR1cm4gZm9yYmlkZGVuVmFsdWVzRXJyb3IoYXJyYXlPZlZhbHVlcywgY2FzZUluc2Vuc2l0aXZlLCBjb250cm9sKTtcbiAgICAgIH0pLFxuICAgICk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JiaWRkZW5WYWx1ZXNFcnJvcihcbiAgdmFsdWVzOiBzdHJpbmdbXSxcbiAgY2FzZUluc2Vuc2l0aXZlOiBib29sZWFuLFxuICBmb3JtQ29udHJvbDogRm9ybUNvbnRyb2w8c3RyaW5nPixcbik6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsIHtcbiAgaWYgKGNhc2VJbnNlbnNpdGl2ZSkge1xuICAgIGNvbnN0IGV4aXN0aW5nVmFsdWUgPSB2YWx1ZXMuZmluZCgodmFsKSA9PiB2YWwudG9Mb3dlckNhc2UoKS50cmltKCkgPT09IGZvcm1Db250cm9sLnZhbHVlLnRvTG93ZXJDYXNlKCkudHJpbSgpKTtcbiAgICByZXR1cm4gZXhpc3RpbmdWYWx1ZSA/IHsgZm9yYmlkZGVuOiB0cnVlLCB2YWx1ZTogZXhpc3RpbmdWYWx1ZSB9IDogbnVsbDtcbiAgfVxuICBpZiAodmFsdWVzLmluY2x1ZGVzKGZvcm1Db250cm9sLnZhbHVlKSkge1xuICAgIHJldHVybiB7IGZvcmJpZGRlbjogdHJ1ZSwgdmFsdWU6IGZvcm1Db250cm9sLnZhbHVlIH07XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==