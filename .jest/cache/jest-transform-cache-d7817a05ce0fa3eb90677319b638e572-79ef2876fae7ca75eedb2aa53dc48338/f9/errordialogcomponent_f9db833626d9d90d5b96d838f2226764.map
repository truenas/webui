{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/dialog/components/error-dialog/error-dialog.component.ts","mappings":";;;;;;;;;AAAA,sDAAuD;AAEvD,wCAEuB;AACvB,qDAAqD;AACrD,qDAEkC;AAClC,yDAAqE;AACrE,8CAAsD;AAEtD,iGAA4F;AAC5F,sEAAkE;AAClE,6EAAwE;AACxE,uEAAmE;AACnE,oEAAgE;AAChE,8EAAyE;AACzE,wDAA2D;AAqBpD,IAAM,oBAAoB,GAA1B,MAAM,oBAAoB;IAa/B,YACS,SAA6C,EAC5C,EAAoB,EACpB,QAAyB,EACzB,YAAiC,EACjC,aAA4B;QAJ7B,cAAS,GAAT,SAAS,CAAoC;QAC5C,OAAE,GAAF,EAAE,CAAkB;QACpB,aAAQ,GAAR,QAAQ,CAAiB;QACzB,iBAAY,GAAZ,YAAY,CAAqB;QACjC,kBAAa,GAAb,aAAa,CAAe;QARtC,oBAAe,GAAG,IAAI,CAAC;IASpB,CAAC;IAEJ,UAAU;QACR,IAAI,CAAC,eAAe,GAAG,CAAC,IAAI,CAAC,eAAe,CAAC;IAC/C,CAAC;IAED,YAAY;QACV,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,wBAAwB,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAA,8BAAc,EAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC;YACjH,IAAI,EAAE,CAAC,GAAG,EAAE,EAAE;gBACZ,MAAM,QAAQ,GAAG,YAAY,CAAC;gBAC9B,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAA,8BAAc,EAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC;oBAC1G,IAAI,EAAE,CAAC,IAAI,EAAE,EAAE;wBACb,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC;wBACxD,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;4BACnB,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;wBACzB,CAAC;oBACH,CAAC;oBACD,KAAK,EAAE,CAAC,GAAsB,EAAE,EAAE;wBAChC,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;4BACnB,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;wBACzB,CAAC;wBACD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC;oBAClE,CAAC;iBACF,CAAC,CAAC;YACL,CAAC;YACD,KAAK,EAAE,CAAC,GAAG,EAAE,EAAE;gBACb,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;YAC9D,CAAC;SACF,CAAC,CAAC;IACL,CAAC;;AAhDU,oDAAoB;;;;;;;;;kCAC9B,gBAAS,SAAC,qBAAqB;yBAC/B,gBAAS,SAAC,YAAY;6BACtB,gBAAS,SAAC,gBAAgB;2BAC1B,gBAAS,SAAC,cAAc;0BACxB,gBAAS,SAAC,aAAa;;+BALb,oBAAoB;IAnBhC,IAAA,4BAAY,GAAE;IACd,IAAA,gBAAS,EAAC;QACT,QAAQ,EAAE,iBAAiB;QAC3B,kDAA4C;QAE5C,eAAe,EAAE,8BAAuB,CAAC,MAAM;QAC/C,UAAU,EAAE,IAAI;QAChB,OAAO,EAAE;YACP,uBAAc;YACd,mCAAe;YACf,yBAAa;YACb,yBAAgB;YAChB,2CAAmB;YACnB,yBAAgB;YAChB,kBAAS;YACT,sBAAe;YACf,8BAAa;SACd;KACF,CAAC;GACW,oBAAoB,CAiDhC","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/dialog/components/error-dialog/error-dialog.component.ts"],"sourcesContent":["import { CdkScrollable } from '@angular/cdk/scrolling';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport {\n  ChangeDetectionStrategy, Component, ElementRef, ViewChild,\n} from '@angular/core';\nimport { MatButton } from '@angular/material/button';\nimport {\n  MatDialogRef, MatDialogTitle, MatDialogContent, MatDialogActions,\n} from '@angular/material/dialog';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { Job } from 'app/interfaces/job.interface';\nimport { CopyButtonComponent } from 'app/modules/buttons/copy-button/copy-button.component';\nimport { DialogService } from 'app/modules/dialog/dialog.service';\nimport { IxIconComponent } from 'app/modules/ix-icon/ix-icon.component';\nimport { TestDirective } from 'app/modules/test-id/test.directive';\nimport { DownloadService } from 'app/services/download.service';\nimport { ErrorHandlerService } from 'app/services/error-handler.service';\nimport { WebSocketService } from 'app/services/ws.service';\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-error-dialog',\n  templateUrl: './error-dialog.component.html',\n  styleUrls: ['./error-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    MatDialogTitle,\n    IxIconComponent,\n    CdkScrollable,\n    MatDialogContent,\n    CopyButtonComponent,\n    MatDialogActions,\n    MatButton,\n    TranslateModule,\n    TestDirective,\n  ],\n})\nexport class ErrorDialogComponent {\n  @ViewChild('errorMessageWrapper') errorMessageWrapper: ElementRef;\n  @ViewChild('errorTitle') errorTitle: ElementRef;\n  @ViewChild('errorMdContent') errorMdContent: ElementRef;\n  @ViewChild('errorBtPanel') errorBtPanel: ElementRef;\n  @ViewChild('errorBtText') errorBtText: ElementRef;\n\n  title: string;\n  message: string;\n  backtrace: string;\n  isCloseMoreInfo = true;\n  logs: Job;\n\n  constructor(\n    public dialogRef: MatDialogRef<ErrorDialogComponent>,\n    private ws: WebSocketService,\n    private download: DownloadService,\n    private errorHandler: ErrorHandlerService,\n    private dialogService: DialogService,\n  ) {}\n\n  toggleOpen(): void {\n    this.isCloseMoreInfo = !this.isCloseMoreInfo;\n  }\n\n  downloadLogs(): void {\n    this.ws.call('core.job_download_logs', [this.logs.id, `${this.logs.id}.log`]).pipe(untilDestroyed(this)).subscribe({\n      next: (url) => {\n        const mimetype = 'text/plain';\n        this.download.streamDownloadFile(url, `${this.logs.id}.log`, mimetype).pipe(untilDestroyed(this)).subscribe({\n          next: (file) => {\n            this.download.downloadBlob(file, `${this.logs.id}.log`);\n            if (this.dialogRef) {\n              this.dialogRef.close();\n            }\n          },\n          error: (err: HttpErrorResponse) => {\n            if (this.dialogRef) {\n              this.dialogRef.close();\n            }\n            this.dialogService.error(this.errorHandler.parseHttpError(err));\n          },\n        });\n      },\n      error: (err) => {\n        this.dialogService.error(this.errorHandler.parseError(err));\n      },\n    });\n  }\n}\n"],"version":3}