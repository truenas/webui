{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/datasets/modules/encryption/components/export-all-keys-dialog/export-all-keys-dialog.component.ts","mappings":";;;;;;;;;AAAA,wCAA2E;AAC3E,qDAAyE;AACzE,yDAAqE;AACrE,8CAA2C;AAC3C,wEAA2D;AAC3D,8EAAyE;AACzE,oEAAgE;AAChE,8EAAyE;AACzE,wDAA2D;AASpD,IAAM,4BAA4B,GAAlC,MAAM,4BAA4B;IACvC,YACU,YAAiC,EACjC,EAAoB,EACpB,MAAwB,EACxB,SAAqD,EACrD,QAAyB,EACD,OAAgB;QALxC,iBAAY,GAAZ,YAAY,CAAqB;QACjC,OAAE,GAAF,EAAE,CAAkB;QACpB,WAAM,GAAN,MAAM,CAAkB;QACxB,cAAS,GAAT,SAAS,CAA4C;QACrD,aAAQ,GAAR,QAAQ,CAAiB;QACD,YAAO,GAAP,OAAO,CAAS;IAC9C,CAAC;IAEL,UAAU;QACR,MAAM,QAAQ,GAAG,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,YAAY,CAAC;QAC/D,MAAM,QAAQ,GAAG,kBAAkB,CAAC;QACpC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE,CAAC,0BAA0B,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,QAAQ,CAAC,CAAC;aACvF,IAAI,CACH,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,EACxB,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,EAC9B,IAAA,qBAAS,EAAC,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC,EAC1E,IAAA,8BAAc,EAAC,IAAI,CAAC,CACrB;aACA,SAAS,CAAC,GAAG,EAAE;YACd,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;IACP,CAAC;;AAvBU,oEAA4B;;;;;;;8DAOpC,aAAM,SAAC,wBAAe;;uCAPd,4BAA4B;IAPxC,IAAA,4BAAY,GAAE;IACd,IAAA,gBAAS,EAAC;QACT,QAAQ,EAAE,2BAA2B;QACrC,4DAAsD;QAEtD,eAAe,EAAE,8BAAuB,CAAC,MAAM;KAChD,CAAC;GACW,4BAA4B,CAwBxC","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/datasets/modules/encryption/components/export-all-keys-dialog/export-all-keys-dialog.component.ts"],"sourcesContent":["import { ChangeDetectionStrategy, Component, Inject } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { switchMap } from 'rxjs/operators';\nimport { Dataset } from 'app/interfaces/dataset.interface';\nimport { AppLoaderService } from 'app/modules/loader/app-loader.service';\nimport { DownloadService } from 'app/services/download.service';\nimport { ErrorHandlerService } from 'app/services/error-handler.service';\nimport { WebSocketService } from 'app/services/ws.service';\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-export-all-keys-dialog',\n  templateUrl: './export-all-keys-dialog.component.html',\n  styleUrls: ['./export-all-keys-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ExportAllKeysDialogComponent {\n  constructor(\n    private errorHandler: ErrorHandlerService,\n    private ws: WebSocketService,\n    private loader: AppLoaderService,\n    private dialogRef: MatDialogRef<ExportAllKeysDialogComponent>,\n    private download: DownloadService,\n    @Inject(MAT_DIALOG_DATA) public dataset: Dataset,\n  ) { }\n\n  onDownload(): void {\n    const fileName = 'dataset_' + this.dataset.name + '_keys.json';\n    const mimetype = 'application/json';\n    this.ws.call('core.download', ['pool.dataset.export_keys', [this.dataset.name], fileName])\n      .pipe(\n        this.loader.withLoader(),\n        this.errorHandler.catchError(),\n        switchMap(([, url]) => this.download.downloadUrl(url, fileName, mimetype)),\n        untilDestroyed(this),\n      )\n      .subscribe(() => {\n        this.dialogRef.close();\n      });\n  }\n}\n"],"version":3}