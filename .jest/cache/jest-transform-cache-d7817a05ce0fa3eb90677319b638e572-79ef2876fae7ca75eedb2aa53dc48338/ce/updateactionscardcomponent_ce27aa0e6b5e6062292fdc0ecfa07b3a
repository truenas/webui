66bd5dc0d2d1b9c0f0a2a383d251ad97
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.UpdateActionsCardComponent = void 0;
const common_1 = require("@angular/common");
const core_1 = require("@angular/core");
const button_1 = require("@angular/material/button");
const card_1 = require("@angular/material/card");
const dialog_1 = require("@angular/material/dialog");
const router_1 = require("@angular/router");
const until_destroy_1 = require("@ngneat/until-destroy");
const store_1 = require("@ngrx/store");
const core_2 = require("@ngx-translate/core");
const rxjs_1 = require("rxjs");
const requires_roles_directive_1 = require("app/directives/requires-roles/requires-roles.directive");
const job_state_enum_1 = require("app/enums/job-state.enum");
const role_enum_1 = require("app/enums/role.enum");
const system_update_enum_1 = require("app/enums/system-update.enum");
const observe_job_operator_1 = require("app/helpers/operators/observe-job.operator");
const window_helper_1 = require("app/helpers/window.helper");
const global_helptext_1 = require("app/helptext/global-helptext");
const update_1 = require("app/helptext/system/update");
const dialog_service_1 = require("app/modules/dialog/dialog.service");
const ix_icon_component_1 = require("app/modules/ix-icon/ix-icon.component");
const job_selectors_1 = require("app/modules/jobs/store/job.selectors");
const app_loader_service_1 = require("app/modules/loader/app-loader.service");
const snackbar_service_1 = require("app/modules/snackbar/services/snackbar.service");
const test_directive_1 = require("app/modules/test-id/test.directive");
const save_config_dialog_component_1 = require("app/pages/system/general-settings/save-config-dialog/save-config-dialog.component");
const update_type_enum_1 = require("app/pages/system/update/enums/update-type.enum");
const train_service_1 = require("app/pages/system/update/services/train.service");
const update_service_1 = require("app/pages/system/update/services/update.service");
const update_again_code_constant_1 = require("app/pages/system/update/utils/update-again-code.constant");
const error_handler_service_1 = require("app/services/error-handler.service");
const system_general_service_1 = require("app/services/system-general.service");
const ws_service_1 = require("app/services/ws.service");
const ha_info_selectors_1 = require("app/store/ha-info/ha-info.selectors");
let UpdateActionsCardComponent = class UpdateActionsCardComponent {
    constructor(router, ws, matDialog, sysGenService, errorHandler, loader, dialogService, translate, store$, snackbar, trainService, updateService, cdr, window) {
        this.router = router;
        this.ws = ws;
        this.matDialog = matDialog;
        this.sysGenService = sysGenService;
        this.errorHandler = errorHandler;
        this.loader = loader;
        this.dialogService = dialogService;
        this.translate = translate;
        this.store$ = store$;
        this.snackbar = snackbar;
        this.trainService = trainService;
        this.updateService = updateService;
        this.cdr = cdr;
        this.window = window;
        this.isUpdateRunning = false;
        this.updateMethod = 'update.update';
        this.isHaLicensed = false;
        this.sysUpdateMessage = global_helptext_1.helptextGlobal.sysUpdateMessage;
        this.sysUpdateMsgPt2 = global_helptext_1.helptextGlobal.sysUpdateMessagePt2;
        this.updateTitle = this.translate.instant('Update');
        this.showApplyPendingButton$ = (0, rxjs_1.combineLatest)([
            this.updateService.updateDownloaded$,
            this.updateService.status$,
        ]).pipe((0, rxjs_1.map)(([updateDownloaded, status]) => updateDownloaded && status !== system_update_enum_1.SystemUpdateStatus.Unavailable));
        this.showDownloadUpdateButton$ = this.updateService.updatesAvailable$;
        this.isDownloadUpdatesButtonDisabled$ = this.updateService.status$.pipe((0, rxjs_1.map)((status) => status === system_update_enum_1.SystemUpdateStatus.RebootRequired));
        this.requiredRoles = [role_enum_1.Role.FullAdmin];
        this.wasConfigurationSaved = false;
        this.sysGenService.updateRunning.pipe((0, until_destroy_1.untilDestroyed)(this)).subscribe((isUpdating) => {
            this.isUpdateRunning = isUpdating === 'true';
            this.cdr.markForCheck();
        });
    }
    ngOnInit() {
        this.store$.select(ha_info_selectors_1.selectIsHaLicensed).pipe((0, until_destroy_1.untilDestroyed)(this)).subscribe((isLicensed) => {
            this.isHaLicensed = isLicensed;
            if (isLicensed) {
                this.updateMethod = 'failover.upgrade';
            }
            this.cdr.markForCheck();
            this.checkForUpdateRunning();
        });
    }
    checkForUpdateRunning() {
        this.ws.call('core.get_jobs', [[['method', '=', this.updateMethod], ['state', '=', job_state_enum_1.JobState.Running]]])
            .pipe((0, until_destroy_1.untilDestroyed)(this)).subscribe({
            next: (jobs) => {
                if (jobs && jobs.length > 0) {
                    this.isUpdateRunning = true;
                    this.showRunningUpdate(jobs[0].id);
                }
                this.cdr.markForCheck();
            },
            error: (err) => {
                console.error(err);
            },
        });
    }
    // Shows an update in progress as a job dialog on the update page
    showRunningUpdate(jobId) {
        const job$ = this.store$.pipe((0, store_1.select)((0, job_selectors_1.selectJob)(jobId)), (0, observe_job_operator_1.observeJob)());
        this.dialogService.jobDialog(job$, {
            title: this.updateTitle,
            canMinimize: true,
        })
            .afterClosed()
            .pipe(this.errorHandler.catchError(), (0, until_destroy_1.untilDestroyed)(this))
            .subscribe(() => {
            this.router.navigate(['/system-tasks/restart'], { skipLocationChange: true });
        });
    }
    downloadUpdate() {
        this.ws.call('core.get_jobs', [[['method', '=', this.updateMethod], ['state', '=', job_state_enum_1.JobState.Running]]])
            .pipe(this.errorHandler.catchError(), (0, until_destroy_1.untilDestroyed)(this))
            .subscribe((jobs) => {
            if (jobs[0]) {
                this.showRunningUpdate(jobs[0].id);
            }
            else {
                this.startUpdate();
            }
            this.cdr.markForCheck();
        });
    }
    applyPendingUpdate() {
        this.updateType = update_type_enum_1.UpdateType.ApplyPending;
        this.saveConfigurationIfNecessary()
            .pipe((0, until_destroy_1.untilDestroyed)(this))
            .subscribe(() => this.continueUpdate());
    }
    manualUpdate() {
        this.updateType = update_type_enum_1.UpdateType.Manual;
        this.saveConfigurationIfNecessary()
            .pipe((0, until_destroy_1.untilDestroyed)(this))
            .subscribe(() => {
            this.router.navigate(['/system/update/manualupdate']);
        });
    }
    startUpdate() {
        this.updateService.error$.next(null);
        this.ws.call('update.check_available').pipe(this.loader.withLoader(), (0, until_destroy_1.untilDestroyed)(this)).subscribe({
            next: (update) => {
                this.updateService.status$.next(update.status);
                if (update.status === system_update_enum_1.SystemUpdateStatus.Available) {
                    const packages = [];
                    update.changes.forEach((change) => {
                        if (change.operation === system_update_enum_1.SystemUpdateOperationType.Upgrade) {
                            packages.push({
                                operation: 'Upgrade',
                                name: change.old.name + '-' + change.old.version
                                    + ' -> ' + change.new.name + '-'
                                    + change.new.version,
                            });
                        }
                        else if (change.operation === system_update_enum_1.SystemUpdateOperationType.Install) {
                            packages.push({
                                operation: 'Install',
                                name: change.new.name + '-' + change.new.version,
                            });
                        }
                        else if (change.operation === system_update_enum_1.SystemUpdateOperationType.Delete) {
                            if (change.old) {
                                packages.push({
                                    operation: 'Delete',
                                    name: change.old.name + '-' + change.old.version,
                                });
                            }
                            else if (change.new) {
                                packages.push({
                                    operation: 'Delete',
                                    name: change.new.name + '-' + change.new.version,
                                });
                            }
                        }
                        else {
                            console.error('Unknown operation:', change.operation);
                        }
                    });
                    this.updateService.packages$.next(packages);
                    if (update.changelog) {
                        this.updateService.changeLog$.next(update.changelog.replace(/\n/g, '<br>'));
                    }
                    if (update.release_notes_url) {
                        this.updateService.releaseNotesUrl$.next(update.release_notes_url);
                    }
                    this.updateType = update_type_enum_1.UpdateType.Standard;
                    this.saveConfigurationIfNecessary()
                        .pipe((0, until_destroy_1.untilDestroyed)(this))
                        .subscribe(() => this.confirmAndUpdate());
                }
                else if (update.status === system_update_enum_1.SystemUpdateStatus.Unavailable) {
                    this.snackbar.success(this.translate.instant('No updates available.'));
                }
            },
            error: (error) => {
                var _a;
                this.dialogService.error({
                    title: this.translate.instant('Error checking for updates.'),
                    message: error.reason,
                    backtrace: (_a = error.trace) === null || _a === void 0 ? void 0 : _a.formatted,
                });
            },
            complete: () => {
                this.loader.close();
                this.cdr.markForCheck();
            },
        });
    }
    // Continues the update process began in startUpdate(), after passing through the Save Config dialog
    confirmAndUpdate() {
        let downloadMsg;
        let confirmMsg;
        if (!this.isHaLicensed) {
            downloadMsg = update_1.helptextSystemUpdate.non_ha_download_msg;
            confirmMsg = update_1.helptextSystemUpdate.non_ha_confirm_msg;
        }
        else {
            downloadMsg = update_1.helptextSystemUpdate.ha_download_msg;
            confirmMsg = update_1.helptextSystemUpdate.ha_confirm_msg;
        }
        this.dialogService.confirm({
            title: this.translate.instant('Download Update'),
            message: this.translate.instant(downloadMsg),
            hideCheckbox: true,
            buttonText: this.translate.instant('Download'),
            secondaryCheckbox: true,
            secondaryCheckboxText: this.translate.instant(confirmMsg),
        })
            .pipe((0, until_destroy_1.untilDestroyed)(this))
            .subscribe((result) => {
            if (!result.confirmed) {
                return;
            }
            if (!result.secondaryCheckbox) {
                this.downloadUpdates();
            }
            else {
                this.update();
            }
        });
    }
    update(resume = false) {
        this.window.sessionStorage.removeItem('updateLastChecked');
        this.window.sessionStorage.removeItem('updateAvailable');
        this.sysGenService.updateRunningNoticeSent.emit();
        let job$;
        if (this.isHaLicensed) {
            job$ = this.trainService.trainValue$.pipe((0, rxjs_1.take)(1), (0, rxjs_1.switchMap)((trainValue) => this.ws.call('update.set_train', [trainValue])), (0, rxjs_1.switchMap)(() => this.ws.job('failover.upgrade', [{ resume }])));
        }
        else {
            job$ = this.ws.job('update.update', [{ resume, reboot: true }]);
        }
        this.dialogService
            .jobDialog(job$, { title: this.translate.instant(this.updateTitle) })
            .afterClosed()
            .pipe((0, rxjs_1.switchMap)(() => {
            this.dialogService.closeAllDialogs();
            this.isUpdateRunning = false;
            this.sysGenService.updateDone(); // Send 'finished' signal to topbar
            this.cdr.markForCheck();
            return this.dialogService.confirm({
                title: update_1.helptextSystemUpdate.ha_update.complete_title,
                message: update_1.helptextSystemUpdate.ha_update.complete_msg,
                hideCheckbox: true,
                buttonText: update_1.helptextSystemUpdate.ha_update.complete_action,
                hideCancel: true,
            });
        }), this.errorHandler.catchError(), (0, until_destroy_1.untilDestroyed)(this))
            .subscribe();
    }
    // Continues the update (based on its type) after the Save Config dialog is closed
    continueUpdate() {
        switch (this.updateType) {
            case update_type_enum_1.UpdateType.ApplyPending: {
                const message = this.isHaLicensed
                    ? this.translate.instant('The standby controller will be automatically restarted to finalize the update. Apply updates and restart the standby controller?')
                    : this.translate.instant('The system will restart and be briefly unavailable while applying updates. Apply updates and restart?');
                this.dialogService.confirm({
                    title: this.translate.instant('Apply Pending Updates'),
                    message: this.translate.instant(message),
                }).pipe((0, rxjs_1.filter)(Boolean), (0, until_destroy_1.untilDestroyed)(this)).subscribe(() => {
                    this.update();
                });
                break;
            }
            case update_type_enum_1.UpdateType.Standard:
                this.confirmAndUpdate();
        }
    }
    saveConfigurationIfNecessary() {
        if (this.wasConfigurationSaved) {
            return (0, rxjs_1.of)(null);
        }
        return this.matDialog.open(save_config_dialog_component_1.SaveConfigDialogComponent, {
            data: {
                title: this.translate.instant('Save configuration settings from this machine before updating?'),
                saveButton: this.translate.instant('Save Configuration'),
                cancelButton: this.translate.instant('Do not save'),
            },
        })
            .afterClosed()
            .pipe((0, rxjs_1.tap)((wasSaved) => {
            if (wasSaved) {
                this.wasConfigurationSaved = true;
            }
        }));
    }
    handleUpdateError(error) {
        if (error.error.includes(update_again_code_constant_1.updateAgainCode)) {
            this.dialogService.confirm({
                title: update_1.helptextSystemUpdate.continueDialogTitle,
                message: error.error.replace(update_again_code_constant_1.updateAgainCode, ''),
                buttonText: update_1.helptextSystemUpdate.continueDialogAction,
            }).pipe((0, rxjs_1.filter)(Boolean), (0, until_destroy_1.untilDestroyed)(this)).subscribe(() => {
                this.update(true);
            });
            return;
        }
        this.dialogService.error(this.errorHandler.parseError(error));
    }
    downloadUpdates() {
        this.dialogService.jobDialog(this.ws.job('update.download'), { title: this.updateTitle })
            .afterClosed()
            .pipe(this.errorHandler.catchError(), (0, until_destroy_1.untilDestroyed)(this))
            .subscribe(() => {
            this.snackbar.success(this.translate.instant('Updates successfully downloaded'));
            this.updateService.pendingUpdates();
        });
    }
};
exports.UpdateActionsCardComponent = UpdateActionsCardComponent;
UpdateActionsCardComponent.ctorParameters = () => [
    { type: router_1.Router },
    { type: ws_service_1.WebSocketService },
    { type: dialog_1.MatDialog },
    { type: system_general_service_1.SystemGeneralService },
    { type: error_handler_service_1.ErrorHandlerService },
    { type: app_loader_service_1.AppLoaderService },
    { type: dialog_service_1.DialogService },
    { type: core_2.TranslateService },
    { type: store_1.Store },
    { type: snackbar_service_1.SnackbarService },
    { type: train_service_1.TrainService },
    { type: update_service_1.UpdateService },
    { type: core_1.ChangeDetectorRef },
    { type: Window, decorators: [{ type: core_1.Inject, args: [window_helper_1.WINDOW,] }] }
];
exports.UpdateActionsCardComponent = UpdateActionsCardComponent = __decorate([
    (0, until_destroy_1.UntilDestroy)(),
    (0, core_1.Component)({
        selector: 'ix-update-actions-card',
        template: require("./update-actions-card.component.html"),
        changeDetection: core_1.ChangeDetectionStrategy.OnPush,
        standalone: true,
        imports: [
            card_1.MatCard,
            ix_icon_component_1.IxIconComponent,
            requires_roles_directive_1.RequiresRolesDirective,
            button_1.MatButton,
            test_directive_1.TestDirective,
            core_2.TranslateModule,
            common_1.AsyncPipe,
        ],
    })
], UpdateActionsCardComponent);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hY2Jvb2sva2FycG92LXdvcmsvVHJ1ZU5BUy93ZWJ1aS9zcmMvYXBwL3BhZ2VzL3N5c3RlbS91cGRhdGUvY29tcG9uZW50cy91cGRhdGUtYWN0aW9ucy1jYXJkL3VwZGF0ZS1hY3Rpb25zLWNhcmQuY29tcG9uZW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLDRDQUE0QztBQUM1Qyx3Q0FFdUI7QUFDdkIscURBQXFEO0FBQ3JELGlEQUFpRDtBQUNqRCxxREFBcUQ7QUFDckQsNENBQXlDO0FBQ3pDLHlEQUFxRTtBQUNyRSx1Q0FBNEM7QUFDNUMsOENBQXdFO0FBQ3hFLCtCQUdjO0FBQ2QscUdBQWdHO0FBQ2hHLDZEQUFvRDtBQUNwRCxtREFBMkM7QUFDM0MscUVBQTZGO0FBQzdGLHFGQUF3RTtBQUN4RSw2REFBbUQ7QUFDbkQsa0VBQThEO0FBQzlELHVEQUE4RTtBQUk5RSxzRUFBa0U7QUFDbEUsNkVBQXdFO0FBQ3hFLHdFQUFpRTtBQUNqRSw4RUFBeUU7QUFDekUscUZBQWlGO0FBQ2pGLHVFQUFtRTtBQUNuRSxvSUFFMkY7QUFDM0YscUZBQTRFO0FBRTVFLGtGQUE4RTtBQUM5RSxvRkFBZ0Y7QUFDaEYseUdBQTJGO0FBQzNGLDhFQUF5RTtBQUN6RSxnRkFBMkU7QUFDM0Usd0RBQTJEO0FBRTNELDJFQUF5RTtBQW1CbEUsSUFBTSwwQkFBMEIsR0FBaEMsTUFBTSwwQkFBMEI7SUF3QnJDLFlBQ1UsTUFBYyxFQUNkLEVBQW9CLEVBQ3BCLFNBQW9CLEVBQ3BCLGFBQW1DLEVBQ25DLFlBQWlDLEVBQ2pDLE1BQXdCLEVBQ3hCLGFBQTRCLEVBQzVCLFNBQTJCLEVBQzNCLE1BQXVCLEVBQ3ZCLFFBQXlCLEVBQ3ZCLFlBQTBCLEVBQzFCLGFBQTRCLEVBQzlCLEdBQXNCLEVBQ04sTUFBYztRQWI5QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsT0FBRSxHQUFGLEVBQUUsQ0FBa0I7UUFDcEIsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNwQixrQkFBYSxHQUFiLGFBQWEsQ0FB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QyxpQ0FBaUMsQ0FBQyxDQUFDLENBQUM7WUFDakYsSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7O0FBblZVLGdFQUEwQjs7Ozs7Ozs7Ozs7Ozs7O3lDQXNDbEMsYUFBTSxTQUFDLHNCQUFNOztxQ0F0Q0wsMEJBQTBCO0lBakJ0QyxJQUFBLDRCQUFZLEdBQUU7SUFDZCxJQUFBLGdCQUFTLEVBQUM7UUFDVCxRQUFRLEVBQUUsd0JBQXdCO1FBRWxDLHlEQUFtRDtRQUNuRCxlQUFlLEVBQUUsOEJBQXVCLENBQUMsTUFBTTtRQUMvQyxVQUFVLEVBQUUsSUFBSTtRQUNoQixPQUFPLEVBQUU7WUFDUCxjQUFPO1lBQ1AsbUNBQWU7WUFDZixpREFBc0I7WUFDdEIsa0JBQVM7WUFDVCw4QkFBYTtZQUNiLHNCQUFlO1lBQ2Ysa0JBQVM7U0FDVjtLQUNGLENBQUM7R0FDVywwQkFBMEIsQ0FvVnRDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYWNib29rL2thcnBvdi13b3JrL1RydWVOQVMvd2VidWkvc3JjL2FwcC9wYWdlcy9zeXN0ZW0vdXBkYXRlL2NvbXBvbmVudHMvdXBkYXRlLWFjdGlvbnMtY2FyZC91cGRhdGUtYWN0aW9ucy1jYXJkLmNvbXBvbmVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc3luY1BpcGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIEluamVjdCwgT25Jbml0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE1hdEJ1dHRvbiB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2J1dHRvbic7XG5pbXBvcnQgeyBNYXRDYXJkIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvY2FyZCc7XG5pbXBvcnQgeyBNYXREaWFsb2cgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9kaWFsb2cnO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IFVudGlsRGVzdHJveSwgdW50aWxEZXN0cm95ZWQgfSBmcm9tICdAbmduZWF0L3VudGlsLWRlc3Ryb3knO1xuaW1wb3J0IHsgc2VsZWN0LCBTdG9yZSB9IGZyb20gJ0BuZ3J4L3N0b3JlJztcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UsIFRyYW5zbGF0ZU1vZHVsZSB9IGZyb20gJ0BuZ3gtdHJhbnNsYXRlL2NvcmUnO1xuaW1wb3J0IHtcbiAgT2JzZXJ2YWJsZSwgb2YsIGZpbHRlciwgdGFwLCBjb21iaW5lTGF0ZXN0LCBtYXAsIHN3aXRjaE1hcCxcbiAgdGFrZSxcbn0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBSZXF1aXJlc1JvbGVzRGlyZWN0aXZlIH0gZnJvbSAnYXBwL2RpcmVjdGl2ZXMvcmVxdWlyZXMtcm9sZXMvcmVxdWlyZXMtcm9sZXMuZGlyZWN0aXZlJztcbmltcG9ydCB7IEpvYlN0YXRlIH0gZnJvbSAnYXBwL2VudW1zL2pvYi1zdGF0ZS5lbnVtJztcbmltcG9ydCB7IFJvbGUgfSBmcm9tICdhcHAvZW51bXMvcm9sZS5lbnVtJztcbmltcG9ydCB7IFN5c3RlbVVwZGF0ZU9wZXJhdGlvblR5cGUsIFN5c3RlbVVwZGF0ZVN0YXR1cyB9IGZyb20gJ2FwcC9lbnVtcy9zeXN0ZW0tdXBkYXRlLmVudW0nO1xuaW1wb3J0IHsgb2JzZXJ2ZUpvYiB9IGZyb20gJ2FwcC9oZWxwZXJzL29wZXJhdG9ycy9vYnNlcnZlLWpvYi5vcGVyYXRvcic7XG5pbXBvcnQgeyBXSU5ET1cgfSBmcm9tICdhcHAvaGVscGVycy93aW5kb3cuaGVscGVyJztcbmltcG9ydCB7IGhlbHB0ZXh0R2xvYmFsIH0gZnJvbSAnYXBwL2hlbHB0ZXh0L2dsb2JhbC1oZWxwdGV4dCc7XG5pbXBvcnQgeyBoZWxwdGV4dFN5c3RlbVVwZGF0ZSBhcyBoZWxwdGV4dCB9IGZyb20gJ2FwcC9oZWxwdGV4dC9zeXN0ZW0vdXBkYXRlJztcbmltcG9ydCB7IEFwaUpvYk1ldGhvZCB9IGZyb20gJ2FwcC9pbnRlcmZhY2VzL2FwaS9hcGktam9iLWRpcmVjdG9yeS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgSm9iIH0gZnJvbSAnYXBwL2ludGVyZmFjZXMvam9iLmludGVyZmFjZSc7XG5pbXBvcnQgeyBXZWJTb2NrZXRFcnJvciB9IGZyb20gJ2FwcC9pbnRlcmZhY2VzL3dlYnNvY2tldC1lcnJvci5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgRGlhbG9nU2VydmljZSB9IGZyb20gJ2FwcC9tb2R1bGVzL2RpYWxvZy9kaWFsb2cuc2VydmljZSc7XG5pbXBvcnQgeyBJeEljb25Db21wb25lbnQgfSBmcm9tICdhcHAvbW9kdWxlcy9peC1pY29uL2l4LWljb24uY29tcG9uZW50JztcbmltcG9ydCB7IHNlbGVjdEpvYiB9IGZyb20gJ2FwcC9tb2R1bGVzL2pvYnMvc3RvcmUvam9iLnNlbGVjdG9ycyc7XG5pbXBvcnQgeyBBcHBMb2FkZXJTZXJ2aWNlIH0gZnJvbSAnYXBwL21vZHVsZXMvbG9hZGVyL2FwcC1sb2FkZXIuc2VydmljZSc7XG5pbXBvcnQgeyBTbmFja2JhclNlcnZpY2UgfSBmcm9tICdhcHAvbW9kdWxlcy9zbmFja2Jhci9zZXJ2aWNlcy9zbmFja2Jhci5zZXJ2aWNlJztcbmltcG9ydCB7IFRlc3REaXJlY3RpdmUgfSBmcm9tICdhcHAvbW9kdWxlcy90ZXN0LWlkL3Rlc3QuZGlyZWN0aXZlJztcbmltcG9ydCB7XG4gIFNhdmVDb25maWdEaWFsb2dDb21wb25lbnQsIFNhdmVDb25maWdEaWFsb2dNZXNzYWdlcyxcbn0gZnJvbSAnYXBwL3BhZ2VzL3N5c3RlbS9nZW5lcmFsLXNldHRpbmdzL3NhdmUtY29uZmlnLWRpYWxvZy9zYXZlLWNvbmZpZy1kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IFVwZGF0ZVR5cGUgfSBmcm9tICdhcHAvcGFnZXMvc3lzdGVtL3VwZGF0ZS9lbnVtcy91cGRhdGUtdHlwZS5lbnVtJztcbmltcG9ydCB7IFBhY2thZ2UgfSBmcm9tICdhcHAvcGFnZXMvc3lzdGVtL3VwZGF0ZS9pbnRlcmZhY2VzL3BhY2thZ2UuaW50ZXJmYWNlJztcbmltcG9ydCB7IFRyYWluU2VydmljZSB9IGZyb20gJ2FwcC9wYWdlcy9zeXN0ZW0vdXBkYXRlL3NlcnZpY2VzL3RyYWluLnNlcnZpY2UnO1xuaW1wb3J0IHsgVXBkYXRlU2VydmljZSB9IGZyb20gJ2FwcC9wYWdlcy9zeXN0ZW0vdXBkYXRlL3NlcnZpY2VzL3VwZGF0ZS5zZXJ2aWNlJztcbmltcG9ydCB7IHVwZGF0ZUFnYWluQ29kZSB9IGZyb20gJ2FwcC9wYWdlcy9zeXN0ZW0vdXBkYXRlL3V0aWxzL3VwZGF0ZS1hZ2Fpbi1jb2RlLmNvbnN0YW50JztcbmltcG9ydCB7IEVycm9ySGFuZGxlclNlcnZpY2UgfSBmcm9tICdhcHAvc2VydmljZXMvZXJyb3ItaGFuZGxlci5zZXJ2aWNlJztcbmltcG9ydCB7IFN5c3RlbUdlbmVyYWxTZXJ2aWNlIH0gZnJvbSAnYXBwL3NlcnZpY2VzL3N5c3RlbS1nZW5lcmFsLnNlcnZpY2UnO1xuaW1wb3J0IHsgV2ViU29ja2V0U2VydmljZSB9IGZyb20gJ2FwcC9zZXJ2aWNlcy93cy5zZXJ2aWNlJztcbmltcG9ydCB7IEFwcFN0YXRlIH0gZnJvbSAnYXBwL3N0b3JlJztcbmltcG9ydCB7IHNlbGVjdElzSGFMaWNlbnNlZCB9IGZyb20gJ2FwcC9zdG9yZS9oYS1pbmZvL2hhLWluZm8uc2VsZWN0b3JzJztcblxuQFVudGlsRGVzdHJveSgpXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdpeC11cGRhdGUtYWN0aW9ucy1jYXJkJyxcbiAgc3R5bGVVcmxzOiBbJ3VwZGF0ZS1hY3Rpb25zLWNhcmQuY29tcG9uZW50LnNjc3MnXSxcbiAgdGVtcGxhdGVVcmw6ICcuL3VwZGF0ZS1hY3Rpb25zLWNhcmQuY29tcG9uZW50Lmh0bWwnLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIE1hdENhcmQsXG4gICAgSXhJY29uQ29tcG9uZW50LFxuICAgIFJlcXVpcmVzUm9sZXNEaXJlY3RpdmUsXG4gICAgTWF0QnV0dG9uLFxuICAgIFRlc3REaXJlY3RpdmUsXG4gICAgVHJhbnNsYXRlTW9kdWxlLFxuICAgIEFzeW5jUGlwZSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgVXBkYXRlQWN0aW9uc0NhcmRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBpc1VwZGF0ZVJ1bm5pbmcgPSBmYWxzZTtcbiAgdXBkYXRlTWV0aG9kOiBBcGlKb2JNZXRob2QgPSAndXBkYXRlLnVwZGF0ZSc7XG4gIGlzSGFMaWNlbnNlZCA9IGZhbHNlO1xuICB1cGRhdGVUeXBlOiBVcGRhdGVUeXBlO1xuICBzeXNVcGRhdGVNZXNzYWdlID0gaGVscHRleHRHbG9iYWwuc3lzVXBkYXRlTWVzc2FnZTtcbiAgc3lzVXBkYXRlTXNnUHQyID0gaGVscHRleHRHbG9iYWwuc3lzVXBkYXRlTWVzc2FnZVB0MjtcbiAgdXBkYXRlVGl0bGUgPSB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KCdVcGRhdGUnKTtcblxuICBzaG93QXBwbHlQZW5kaW5nQnV0dG9uJCA9IGNvbWJpbmVMYXRlc3QoW1xuICAgIHRoaXMudXBkYXRlU2VydmljZS51cGRhdGVEb3dubG9hZGVkJCxcbiAgICB0aGlzLnVwZGF0ZVNlcnZpY2Uuc3RhdHVzJCxcbiAgXSkucGlwZShtYXAoKFt1cGRhdGVEb3dubG9hZGVkLCBzdGF0dXNdKSA9PiB1cGRhdGVEb3dubG9hZGVkICYmIHN0YXR1cyAhPT0gU3lzdGVtVXBkYXRlU3RhdHVzLlVuYXZhaWxhYmxlKSk7XG5cbiAgc2hvd0Rvd25sb2FkVXBkYXRlQnV0dG9uJCA9IHRoaXMudXBkYXRlU2VydmljZS51cGRhdGVzQXZhaWxhYmxlJDtcblxuICBpc0Rvd25sb2FkVXBkYXRlc0J1dHRvbkRpc2FibGVkJCA9IHRoaXMudXBkYXRlU2VydmljZS5zdGF0dXMkLnBpcGUoXG4gICAgbWFwKChzdGF0dXMpID0+IHN0YXR1cyA9PT0gU3lzdGVtVXBkYXRlU3RhdHVzLlJlYm9vdFJlcXVpcmVkKSxcbiAgKTtcblxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgcmVxdWlyZWRSb2xlcyA9IFtSb2xlLkZ1bGxBZG1pbl07XG5cbiAgcHJpdmF0ZSB3YXNDb25maWd1cmF0aW9uU2F2ZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxuICAgIHByaXZhdGUgd3M6IFdlYlNvY2tldFNlcnZpY2UsXG4gICAgcHJpdmF0ZSBtYXREaWFsb2c6IE1hdERpYWxvZyxcbiAgICBwcml2YXRlIHN5c0dlblNlcnZpY2U6IFN5c3RlbUdlbmVyYWxTZXJ2aWNlLFxuICAgIHByaXZhdGUgZXJyb3JIYW5kbGVyOiBFcnJvckhhbmRsZXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgbG9hZGVyOiBBcHBMb2FkZXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgZGlhbG9nU2VydmljZTogRGlhbG9nU2VydmljZSxcbiAgICBwcml2YXRlIHRyYW5zbGF0ZTogVHJhbnNsYXRlU2VydmljZSxcbiAgICBwcml2YXRlIHN0b3JlJDogU3RvcmU8QXBwU3RhdGU+LFxuICAgIHByaXZhdGUgc25hY2tiYXI6IFNuYWNrYmFyU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgdHJhaW5TZXJ2aWNlOiBUcmFpblNlcnZpY2UsXG4gICAgcHJvdGVjdGVkIHVwZGF0ZVNlcnZpY2U6IFVwZGF0ZVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxuICAgIEBJbmplY3QoV0lORE9XKSBwcml2YXRlIHdpbmRvdzogV2luZG93LFxuICApIHtcbiAgICB0aGlzLnN5c0dlblNlcnZpY2UudXBkYXRlUnVubmluZy5waXBlKHVudGlsRGVzdHJveWVkKHRoaXMpKS5zdWJzY3JpYmUoKGlzVXBkYXRpbmc6IHN0cmluZykgPT4ge1xuICAgICAgdGhpcy5pc1VwZGF0ZVJ1bm5pbmcgPSBpc1VwZGF0aW5nID09PSAndHJ1ZSc7XG4gICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcmUkLnNlbGVjdChzZWxlY3RJc0hhTGljZW5zZWQpLnBpcGUodW50aWxEZXN0cm95ZWQodGhpcykpLnN1YnNjcmliZSgoaXNMaWNlbnNlZCkgPT4ge1xuICAgICAgdGhpcy5pc0hhTGljZW5zZWQgPSBpc0xpY2Vuc2VkO1xuICAgICAgaWYgKGlzTGljZW5zZWQpIHtcbiAgICAgICAgdGhpcy51cGRhdGVNZXRob2QgPSAnZmFpbG92ZXIudXBncmFkZSc7XG4gICAgICB9XG4gICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIHRoaXMuY2hlY2tGb3JVcGRhdGVSdW5uaW5nKCk7XG4gICAgfSk7XG4gIH1cblxuICBjaGVja0ZvclVwZGF0ZVJ1bm5pbmcoKTogdm9pZCB7XG4gICAgdGhpcy53cy5jYWxsKCdjb3JlLmdldF9qb2JzJywgW1tbJ21ldGhvZCcsICc9JywgdGhpcy51cGRhdGVNZXRob2RdLCBbJ3N0YXRlJywgJz0nLCBKb2JTdGF0ZS5SdW5uaW5nXV1dKVxuICAgICAgLnBpcGUodW50aWxEZXN0cm95ZWQodGhpcykpLnN1YnNjcmliZSh7XG4gICAgICAgIG5leHQ6IChqb2JzKSA9PiB7XG4gICAgICAgICAgaWYgKGpvYnMgJiYgam9icy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmlzVXBkYXRlUnVubmluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnNob3dSdW5uaW5nVXBkYXRlKGpvYnNbMF0uaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IChlcnIpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgfVxuXG4gIC8vIFNob3dzIGFuIHVwZGF0ZSBpbiBwcm9ncmVzcyBhcyBhIGpvYiBkaWFsb2cgb24gdGhlIHVwZGF0ZSBwYWdlXG4gIHNob3dSdW5uaW5nVXBkYXRlKGpvYklkOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBqb2IkID0gdGhpcy5zdG9yZSQucGlwZShcbiAgICAgIHNlbGVjdChzZWxlY3RKb2Ioam9iSWQpKSxcbiAgICAgIG9ic2VydmVKb2IoKSxcbiAgICApIGFzIE9ic2VydmFibGU8Sm9iPEFwaUpvYk1ldGhvZD4+O1xuXG4gICAgdGhpcy5kaWFsb2dTZXJ2aWNlLmpvYkRpYWxvZyhcbiAgICAgIGpvYiQsXG4gICAgICB7XG4gICAgICAgIHRpdGxlOiB0aGlzLnVwZGF0ZVRpdGxlLFxuICAgICAgICBjYW5NaW5pbWl6ZTogdHJ1ZSxcbiAgICAgIH0sXG4gICAgKVxuICAgICAgLmFmdGVyQ2xvc2VkKClcbiAgICAgIC5waXBlKFxuICAgICAgICB0aGlzLmVycm9ySGFuZGxlci5jYXRjaEVycm9yKCksXG4gICAgICAgIHVudGlsRGVzdHJveWVkKHRoaXMpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnL3N5c3RlbS10YXNrcy9yZXN0YXJ0J10sIHsgc2tpcExvY2F0aW9uQ2hhbmdlOiB0cnVlIH0pO1xuICAgICAgfSk7XG4gIH1cblxuICBkb3dubG9hZFVwZGF0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLndzLmNhbGwoJ2NvcmUuZ2V0X2pvYnMnLCBbW1snbWV0aG9kJywgJz0nLCB0aGlzLnVwZGF0ZU1ldGhvZF0sIFsnc3RhdGUnLCAnPScsIEpvYlN0YXRlLlJ1bm5pbmddXV0pXG4gICAgICAucGlwZSh0aGlzLmVycm9ySGFuZGxlci5jYXRjaEVycm9yKCksIHVudGlsRGVzdHJveWVkKHRoaXMpKVxuICAgICAgLnN1YnNjcmliZSgoam9icykgPT4ge1xuICAgICAgICBpZiAoam9ic1swXSkge1xuICAgICAgICAgIHRoaXMuc2hvd1J1bm5pbmdVcGRhdGUoam9ic1swXS5pZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zdGFydFVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgfSk7XG4gIH1cblxuICBhcHBseVBlbmRpbmdVcGRhdGUoKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGVUeXBlID0gVXBkYXRlVHlwZS5BcHBseVBlbmRpbmc7XG4gICAgdGhpcy5zYXZlQ29uZmlndXJhdGlvbklmTmVjZXNzYXJ5KClcbiAgICAgIC5waXBlKHVudGlsRGVzdHJveWVkKHRoaXMpKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNvbnRpbnVlVXBkYXRlKCkpO1xuICB9XG5cbiAgbWFudWFsVXBkYXRlKCk6IHZvaWQge1xuICAgIHRoaXMudXBkYXRlVHlwZSA9IFVwZGF0ZVR5cGUuTWFudWFsO1xuICAgIHRoaXMuc2F2ZUNvbmZpZ3VyYXRpb25JZk5lY2Vzc2FyeSgpXG4gICAgICAucGlwZSh1bnRpbERlc3Ryb3llZCh0aGlzKSlcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy9zeXN0ZW0vdXBkYXRlL21hbnVhbHVwZGF0ZSddKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgc3RhcnRVcGRhdGUoKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGVTZXJ2aWNlLmVycm9yJC5uZXh0KG51bGwpO1xuICAgIHRoaXMud3MuY2FsbCgndXBkYXRlLmNoZWNrX2F2YWlsYWJsZScpLnBpcGUodGhpcy5sb2FkZXIud2l0aExvYWRlcigpLCB1bnRpbERlc3Ryb3llZCh0aGlzKSkuc3Vic2NyaWJlKHtcbiAgICAgIG5leHQ6ICh1cGRhdGUpID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVTZXJ2aWNlLnN0YXR1cyQubmV4dCh1cGRhdGUuc3RhdHVzKTtcbiAgICAgICAgaWYgKHVwZGF0ZS5zdGF0dXMgPT09IFN5c3RlbVVwZGF0ZVN0YXR1cy5BdmFpbGFibGUpIHtcbiAgICAgICAgICBjb25zdCBwYWNrYWdlczogUGFja2FnZVtdID0gW107XG4gICAgICAgICAgdXBkYXRlLmNoYW5nZXMuZm9yRWFjaCgoY2hhbmdlKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlLm9wZXJhdGlvbiA9PT0gU3lzdGVtVXBkYXRlT3BlcmF0aW9uVHlwZS5VcGdyYWRlKSB7XG4gICAgICAgICAgICAgIHBhY2thZ2VzLnB1c2goe1xuICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogJ1VwZ3JhZGUnLFxuICAgICAgICAgICAgICAgIG5hbWU6IGNoYW5nZS5vbGQubmFtZSArICctJyArIGNoYW5nZS5vbGQudmVyc2lvblxuICAgICAgICAgICAgICAgICsgJyAtPiAnICsgY2hhbmdlLm5ldy5uYW1lICsgJy0nXG4gICAgICAgICAgICAgICAgKyBjaGFuZ2UubmV3LnZlcnNpb24sXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFuZ2Uub3BlcmF0aW9uID09PSBTeXN0ZW1VcGRhdGVPcGVyYXRpb25UeXBlLkluc3RhbGwpIHtcbiAgICAgICAgICAgICAgcGFja2FnZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgb3BlcmF0aW9uOiAnSW5zdGFsbCcsXG4gICAgICAgICAgICAgICAgbmFtZTogY2hhbmdlLm5ldy5uYW1lICsgJy0nICsgY2hhbmdlLm5ldy52ZXJzaW9uLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbmdlLm9wZXJhdGlvbiA9PT0gU3lzdGVtVXBkYXRlT3BlcmF0aW9uVHlwZS5EZWxldGUpIHtcbiAgICAgICAgICAgICAgaWYgKGNoYW5nZS5vbGQpIHtcbiAgICAgICAgICAgICAgICBwYWNrYWdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogJ0RlbGV0ZScsXG4gICAgICAgICAgICAgICAgICBuYW1lOiBjaGFuZ2Uub2xkLm5hbWUgKyAnLScgKyBjaGFuZ2Uub2xkLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbmdlLm5ldykge1xuICAgICAgICAgICAgICAgIHBhY2thZ2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uOiAnRGVsZXRlJyxcbiAgICAgICAgICAgICAgICAgIG5hbWU6IGNoYW5nZS5uZXcubmFtZSArICctJyArIGNoYW5nZS5uZXcudmVyc2lvbixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignVW5rbm93biBvcGVyYXRpb246JywgY2hhbmdlLm9wZXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy51cGRhdGVTZXJ2aWNlLnBhY2thZ2VzJC5uZXh0KHBhY2thZ2VzKTtcblxuICAgICAgICAgIGlmICh1cGRhdGUuY2hhbmdlbG9nKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlcnZpY2UuY2hhbmdlTG9nJC5uZXh0KHVwZGF0ZS5jaGFuZ2Vsb2cucmVwbGFjZSgvXFxuL2csICc8YnI+JykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodXBkYXRlLnJlbGVhc2Vfbm90ZXNfdXJsKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlcnZpY2UucmVsZWFzZU5vdGVzVXJsJC5uZXh0KHVwZGF0ZS5yZWxlYXNlX25vdGVzX3VybCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMudXBkYXRlVHlwZSA9IFVwZGF0ZVR5cGUuU3RhbmRhcmQ7XG4gICAgICAgICAgdGhpcy5zYXZlQ29uZmlndXJhdGlvbklmTmVjZXNzYXJ5KClcbiAgICAgICAgICAgIC5waXBlKHVudGlsRGVzdHJveWVkKHRoaXMpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNvbmZpcm1BbmRVcGRhdGUoKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodXBkYXRlLnN0YXR1cyA9PT0gU3lzdGVtVXBkYXRlU3RhdHVzLlVuYXZhaWxhYmxlKSB7XG4gICAgICAgICAgdGhpcy5zbmFja2Jhci5zdWNjZXNzKHRoaXMudHJhbnNsYXRlLmluc3RhbnQoJ05vIHVwZGF0ZXMgYXZhaWxhYmxlLicpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGVycm9yOiAoZXJyb3I6IFdlYlNvY2tldEVycm9yKSA9PiB7XG4gICAgICAgIHRoaXMuZGlhbG9nU2VydmljZS5lcnJvcih7XG4gICAgICAgICAgdGl0bGU6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoJ0Vycm9yIGNoZWNraW5nIGZvciB1cGRhdGVzLicpLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLnJlYXNvbixcbiAgICAgICAgICBiYWNrdHJhY2U6IGVycm9yLnRyYWNlPy5mb3JtYXR0ZWQsXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAgIHRoaXMubG9hZGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuY2RyLm1hcmtGb3JDaGVjaygpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIENvbnRpbnVlcyB0aGUgdXBkYXRlIHByb2Nlc3MgYmVnYW4gaW4gc3RhcnRVcGRhdGUoKSwgYWZ0ZXIgcGFzc2luZyB0aHJvdWdoIHRoZSBTYXZlIENvbmZpZyBkaWFsb2dcbiAgY29uZmlybUFuZFVwZGF0ZSgpOiB2b2lkIHtcbiAgICBsZXQgZG93bmxvYWRNc2c7XG4gICAgbGV0IGNvbmZpcm1Nc2c7XG5cbiAgICBpZiAoIXRoaXMuaXNIYUxpY2Vuc2VkKSB7XG4gICAgICBkb3dubG9hZE1zZyA9IGhlbHB0ZXh0Lm5vbl9oYV9kb3dubG9hZF9tc2c7XG4gICAgICBjb25maXJtTXNnID0gaGVscHRleHQubm9uX2hhX2NvbmZpcm1fbXNnO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb3dubG9hZE1zZyA9IGhlbHB0ZXh0LmhhX2Rvd25sb2FkX21zZztcbiAgICAgIGNvbmZpcm1Nc2cgPSBoZWxwdGV4dC5oYV9jb25maXJtX21zZztcbiAgICB9XG5cbiAgICB0aGlzLmRpYWxvZ1NlcnZpY2UuY29uZmlybSh7XG4gICAgICB0aXRsZTogdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnRG93bmxvYWQgVXBkYXRlJyksXG4gICAgICBtZXNzYWdlOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KGRvd25sb2FkTXNnKSxcbiAgICAgIGhpZGVDaGVja2JveDogdHJ1ZSxcbiAgICAgIGJ1dHRvblRleHQ6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoJ0Rvd25sb2FkJyksXG4gICAgICBzZWNvbmRhcnlDaGVja2JveDogdHJ1ZSxcbiAgICAgIHNlY29uZGFyeUNoZWNrYm94VGV4dDogdGhpcy50cmFuc2xhdGUuaW5zdGFudChjb25maXJtTXNnKSxcbiAgICB9KVxuICAgICAgLnBpcGUodW50aWxEZXN0cm95ZWQodGhpcykpXG4gICAgICAuc3Vic2NyaWJlKChyZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKCFyZXN1bHQuY29uZmlybWVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXN1bHQuc2Vjb25kYXJ5Q2hlY2tib3gpIHtcbiAgICAgICAgICB0aGlzLmRvd25sb2FkVXBkYXRlcygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGUocmVzdW1lID0gZmFsc2UpOiB2b2lkIHtcbiAgICB0aGlzLndpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd1cGRhdGVMYXN0Q2hlY2tlZCcpO1xuICAgIHRoaXMud2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ3VwZGF0ZUF2YWlsYWJsZScpO1xuICAgIHRoaXMuc3lzR2VuU2VydmljZS51cGRhdGVSdW5uaW5nTm90aWNlU2VudC5lbWl0KCk7XG5cbiAgICBsZXQgam9iJDogT2JzZXJ2YWJsZTxKb2I+O1xuICAgIGlmICh0aGlzLmlzSGFMaWNlbnNlZCkge1xuICAgICAgam9iJCA9IHRoaXMudHJhaW5TZXJ2aWNlLnRyYWluVmFsdWUkLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHN3aXRjaE1hcCgodHJhaW5WYWx1ZSkgPT4gdGhpcy53cy5jYWxsKCd1cGRhdGUuc2V0X3RyYWluJywgW3RyYWluVmFsdWVdKSksXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PiB0aGlzLndzLmpvYignZmFpbG92ZXIudXBncmFkZScsIFt7IHJlc3VtZSB9XSkpLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgam9iJCA9IHRoaXMud3Muam9iKCd1cGRhdGUudXBkYXRlJywgW3sgcmVzdW1lLCByZWJvb3Q6IHRydWUgfV0pO1xuICAgIH1cblxuICAgIHRoaXMuZGlhbG9nU2VydmljZVxuICAgICAgLmpvYkRpYWxvZyhqb2IkLCB7IHRpdGxlOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KHRoaXMudXBkYXRlVGl0bGUpIH0pXG4gICAgICAuYWZ0ZXJDbG9zZWQoKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5kaWFsb2dTZXJ2aWNlLmNsb3NlQWxsRGlhbG9ncygpO1xuICAgICAgICAgIHRoaXMuaXNVcGRhdGVSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5zeXNHZW5TZXJ2aWNlLnVwZGF0ZURvbmUoKTsgLy8gU2VuZCAnZmluaXNoZWQnIHNpZ25hbCB0byB0b3BiYXJcbiAgICAgICAgICB0aGlzLmNkci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5kaWFsb2dTZXJ2aWNlLmNvbmZpcm0oe1xuICAgICAgICAgICAgdGl0bGU6IGhlbHB0ZXh0LmhhX3VwZGF0ZS5jb21wbGV0ZV90aXRsZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGhlbHB0ZXh0LmhhX3VwZGF0ZS5jb21wbGV0ZV9tc2csXG4gICAgICAgICAgICBoaWRlQ2hlY2tib3g6IHRydWUsXG4gICAgICAgICAgICBidXR0b25UZXh0OiBoZWxwdGV4dC5oYV91cGRhdGUuY29tcGxldGVfYWN0aW9uLFxuICAgICAgICAgICAgaGlkZUNhbmNlbDogdHJ1ZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIHRoaXMuZXJyb3JIYW5kbGVyLmNhdGNoRXJyb3IoKSxcbiAgICAgICAgdW50aWxEZXN0cm95ZWQodGhpcyksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCk7XG4gIH1cblxuICAvLyBDb250aW51ZXMgdGhlIHVwZGF0ZSAoYmFzZWQgb24gaXRzIHR5cGUpIGFmdGVyIHRoZSBTYXZlIENvbmZpZyBkaWFsb2cgaXMgY2xvc2VkXG4gIGNvbnRpbnVlVXBkYXRlKCk6IHZvaWQge1xuICAgIHN3aXRjaCAodGhpcy51cGRhdGVUeXBlKSB7XG4gICAgICBjYXNlIFVwZGF0ZVR5cGUuQXBwbHlQZW5kaW5nOiB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmlzSGFMaWNlbnNlZFxuICAgICAgICAgID8gdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnVGhlIHN0YW5kYnkgY29udHJvbGxlciB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgcmVzdGFydGVkIHRvIGZpbmFsaXplIHRoZSB1cGRhdGUuIEFwcGx5IHVwZGF0ZXMgYW5kIHJlc3RhcnQgdGhlIHN0YW5kYnkgY29udHJvbGxlcj8nKVxuICAgICAgICAgIDogdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnVGhlIHN5c3RlbSB3aWxsIHJlc3RhcnQgYW5kIGJlIGJyaWVmbHkgdW5hdmFpbGFibGUgd2hpbGUgYXBwbHlpbmcgdXBkYXRlcy4gQXBwbHkgdXBkYXRlcyBhbmQgcmVzdGFydD8nKTtcbiAgICAgICAgdGhpcy5kaWFsb2dTZXJ2aWNlLmNvbmZpcm0oe1xuICAgICAgICAgIHRpdGxlOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KCdBcHBseSBQZW5kaW5nIFVwZGF0ZXMnKSxcbiAgICAgICAgICBtZXNzYWdlOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KG1lc3NhZ2UpLFxuICAgICAgICB9KS5waXBlKGZpbHRlcihCb29sZWFuKSwgdW50aWxEZXN0cm95ZWQodGhpcykpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBVcGRhdGVUeXBlLlN0YW5kYXJkOlxuICAgICAgICB0aGlzLmNvbmZpcm1BbmRVcGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNhdmVDb25maWd1cmF0aW9uSWZOZWNlc3NhcnkoKTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMud2FzQ29uZmlndXJhdGlvblNhdmVkKSB7XG4gICAgICByZXR1cm4gb2YobnVsbCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubWF0RGlhbG9nLm9wZW4oU2F2ZUNvbmZpZ0RpYWxvZ0NvbXBvbmVudCwge1xuICAgICAgZGF0YToge1xuICAgICAgICB0aXRsZTogdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnU2F2ZSBjb25maWd1cmF0aW9uIHNldHRpbmdzIGZyb20gdGhpcyBtYWNoaW5lIGJlZm9yZSB1cGRhdGluZz8nKSxcbiAgICAgICAgc2F2ZUJ1dHRvbjogdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnU2F2ZSBDb25maWd1cmF0aW9uJyksXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogdGhpcy50cmFuc2xhdGUuaW5zdGFudCgnRG8gbm90IHNhdmUnKSxcbiAgICAgIH0gYXMgUGFydGlhbDxTYXZlQ29uZmlnRGlhbG9nTWVzc2FnZXM+LFxuICAgIH0pXG4gICAgICAuYWZ0ZXJDbG9zZWQoKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRhcCgod2FzU2F2ZWQpID0+IHtcbiAgICAgICAgICBpZiAod2FzU2F2ZWQpIHtcbiAgICAgICAgICAgIHRoaXMud2FzQ29uZmlndXJhdGlvblNhdmVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlVXBkYXRlRXJyb3IoZXJyb3I6IEpvYik6IHZvaWQge1xuICAgIGlmIChlcnJvci5lcnJvci5pbmNsdWRlcyh1cGRhdGVBZ2FpbkNvZGUpKSB7XG4gICAgICB0aGlzLmRpYWxvZ1NlcnZpY2UuY29uZmlybSh7XG4gICAgICAgIHRpdGxlOiBoZWxwdGV4dC5jb250aW51ZURpYWxvZ1RpdGxlLFxuICAgICAgICBtZXNzYWdlOiBlcnJvci5lcnJvci5yZXBsYWNlKHVwZGF0ZUFnYWluQ29kZSwgJycpLFxuICAgICAgICBidXR0b25UZXh0OiBoZWxwdGV4dC5jb250aW51ZURpYWxvZ0FjdGlvbixcbiAgICAgIH0pLnBpcGUoXG4gICAgICAgIGZpbHRlcihCb29sZWFuKSxcbiAgICAgICAgdW50aWxEZXN0cm95ZWQodGhpcyksXG4gICAgICApLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgIHRoaXMudXBkYXRlKHRydWUpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuZGlhbG9nU2VydmljZS5lcnJvcih0aGlzLmVycm9ySGFuZGxlci5wYXJzZUVycm9yKGVycm9yKSk7XG4gIH1cblxuICBwcml2YXRlIGRvd25sb2FkVXBkYXRlcygpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZ1NlcnZpY2Uuam9iRGlhbG9nKFxuICAgICAgdGhpcy53cy5qb2IoJ3VwZGF0ZS5kb3dubG9hZCcpLFxuICAgICAgeyB0aXRsZTogdGhpcy51cGRhdGVUaXRsZSB9LFxuICAgIClcbiAgICAgIC5hZnRlckNsb3NlZCgpXG4gICAgICAucGlwZShcbiAgICAgICAgdGhpcy5lcnJvckhhbmRsZXIuY2F0Y2hFcnJvcigpLFxuICAgICAgICB1bnRpbERlc3Ryb3llZCh0aGlzKSxcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICB0aGlzLnNuYWNrYmFyLnN1Y2Nlc3ModGhpcy50cmFuc2xhdGUuaW5zdGFudCgnVXBkYXRlcyBzdWNjZXNzZnVsbHkgZG93bmxvYWRlZCcpKTtcbiAgICAgICAgdGhpcy51cGRhdGVTZXJ2aWNlLnBlbmRpbmdVcGRhdGVzKCk7XG4gICAgICB9KTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9