c1197a8a719df5a4c50dd335f9d1a76b
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.IxPermissionsHarness = void 0;
const testing_1 = require("@angular/cdk/testing");
const testing_2 = require("@angular/material/checkbox/testing");
const posix_acl_enum_1 = require("app/enums/posix-acl.enum");
const mode_helper_1 = require("app/helpers/mode.helper");
const ix_label_harness_1 = require("app/modules/forms/ix-forms/components/ix-label/ix-label.harness");
const harness_utils_1 = require("app/modules/forms/ix-forms/utils/harness.utils");
class IxPermissionsHarness extends testing_1.ComponentHarness {
    constructor() {
        super(...arguments);
        this.getMatCheckboxHarnesses = this.locatorForAll(testing_2.MatCheckboxHarness);
        this.getErrorText = harness_utils_1.getErrorText;
    }
    static with(options) {
        return new testing_1.HarnessPredicate(IxPermissionsHarness, options)
            .addOption('label', options.label, (harness, label) => testing_1.HarnessPredicate.stringMatches(harness.getLabelText(), label));
    }
    getLabelText() {
        return __awaiter(this, void 0, void 0, function* () {
            const label = yield this.locatorForOptional(ix_label_harness_1.IxLabelHarness)();
            if (!label) {
                return '';
            }
            return label.getLabel();
        });
    }
    getValue() {
        return __awaiter(this, void 0, void 0, function* () {
            const permissions = (yield this.getMatCheckboxHarnesses());
            let owner = 0;
            let grp = 0;
            let other = 0;
            if ((yield permissions[0].isChecked())) {
                owner += 4;
            }
            if ((yield permissions[1].isChecked())) {
                owner += 2;
            }
            if ((yield permissions[2].isChecked())) {
                owner += 1;
            }
            if ((yield permissions[3].isChecked())) {
                grp += 4;
            }
            if ((yield permissions[4].isChecked())) {
                grp += 2;
            }
            if ((yield permissions[5].isChecked())) {
                grp += 1;
            }
            if (permissions.length > 6) {
                if ((yield permissions[6].isChecked())) {
                    other += 4;
                }
                if ((yield permissions[7].isChecked())) {
                    other += 2;
                }
                if ((yield permissions[8].isChecked())) {
                    other += 1;
                }
            }
            return Promise.resolve(owner.toString() + grp.toString() + other.toString());
        });
    }
    setValue(value) {
        return __awaiter(this, void 0, void 0, function* () {
            const checkboxes = (yield this.getMatCheckboxHarnesses());
            const permissions = (0, mode_helper_1.parseMode)(value);
            return Promise.all([
                permissions.owner[posix_acl_enum_1.PosixPermission.Read] ? checkboxes[0].check() : checkboxes[0].uncheck(),
                permissions.owner[posix_acl_enum_1.PosixPermission.Write] ? checkboxes[1].check() : checkboxes[1].uncheck(),
                permissions.owner[posix_acl_enum_1.PosixPermission.Execute] ? checkboxes[2].check() : checkboxes[2].uncheck(),
                permissions.group[posix_acl_enum_1.PosixPermission.Read] ? checkboxes[3].check() : checkboxes[3].uncheck(),
                permissions.group[posix_acl_enum_1.PosixPermission.Write] ? checkboxes[4].check() : checkboxes[4].uncheck(),
                permissions.group[posix_acl_enum_1.PosixPermission.Execute] ? checkboxes[5].check() : checkboxes[5].uncheck(),
                permissions.other[posix_acl_enum_1.PosixPermission.Read] ? checkboxes[6].check() : checkboxes[6].uncheck(),
                permissions.other[posix_acl_enum_1.PosixPermission.Write] ? checkboxes[7].check() : checkboxes[7].uncheck(),
                permissions.other[posix_acl_enum_1.PosixPermission.Execute] ? checkboxes[8].check() : checkboxes[8].uncheck(),
            ]).then(() => { });
        });
    }
    isDisabled() {
        return __awaiter(this, void 0, void 0, function* () {
            const checkboxes = yield this.getMatCheckboxHarnesses();
            const inputState = yield (0, testing_1.parallel)(() => checkboxes.map((control) => control.isDisabled()));
            return inputState.every((control) => !!control);
        });
    }
}
exports.IxPermissionsHarness = IxPermissionsHarness;
IxPermissionsHarness.hostSelector = 'ix-permissions';
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hY2Jvb2sva2FycG92LXdvcmsvVHJ1ZU5BUy93ZWJ1aS9zcmMvYXBwL21vZHVsZXMvZm9ybXMvaXgtZm9ybXMvY29tcG9uZW50cy9peC1wZXJtaXNzaW9ucy9peC1wZXJtaXNzaW9ucy5oYXJuZXNzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLGtEQUU4QjtBQUM5QixnRUFBd0U7QUFDeEUsNkRBQTJEO0FBQzNELHlEQUFvRDtBQUNwRCxzR0FBaUc7QUFFakcsa0ZBQThFO0FBTTlFLE1BQWEsb0JBQXFCLFNBQVEsMEJBQWdCO0lBQTFEOztRQVFFLDRCQUF1QixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsNEJBQWtCLENBQUMsQ0FBQztRQUNqRSxpQkFBWSxHQUFHLDRCQUFZLENBQUM7SUFnRjlCLENBQUM7SUF0RkMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFvQztRQUM5QyxPQUFPLElBQUksMEJBQWdCLENBQUMsb0JBQW9CLEVBQUUsT0FBTyxDQUFDO2FBQ3ZELFNBQVMsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDLDBCQUFnQixDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMxSCxDQUFDO0lBS0ssWUFBWTs7WUFDaEIsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsaUNBQWMsQ0FBQyxFQUFFLENBQUM7WUFDOUQsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1osQ0FBQztZQUNELE9BQU8sS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzFCLENBQUM7S0FBQTtJQUVLLFFBQVE7O1lBQ1osTUFBTSxXQUFXLEdBQUcsQ0FBQyxNQUFNLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxDQUFDLENBQUM7WUFDM0QsSUFBSSxLQUFLLEdBQUcsQ0FBQyxD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LENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRTtnQkFDNUYsV0FBVyxDQUFDLEtBQUssQ0FBQyxnQ0FBZSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ3pGLFdBQVcsQ0FBQyxLQUFLLENBQUMsZ0NBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFO2dCQUMxRixXQUFXLENBQUMsS0FBSyxDQUFDLGdDQUFlLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRTtnQkFDNUYsV0FBVyxDQUFDLEtBQUssQ0FBQyxnQ0FBZSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ3pGLFdBQVcsQ0FBQyxLQUFLLENBQUMsZ0NBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFO2dCQUMxRixXQUFXLENBQUMsS0FBSyxDQUFDLGdDQUFlLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRTthQUM3RixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3BCLENBQUM7S0FBQTtJQUVLLFVBQVU7O1lBQ2QsTUFBTSxVQUFVLEdBQUcsTUFBTSxJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQztZQUN4RCxNQUFNLFVBQVUsR0FBRyxNQUFNLElBQUEsa0JBQVEsRUFBQyxHQUFHLEVBQUUsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRTNGLE9BQU8sVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2xELENBQUM7S0FBQTs7QUF4Rkgsb0RBeUZDO0FBeEZpQixpQ0FBWSxHQUFHLGdCQUFnQixBQUFuQixDQUFvQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvbWFjYm9vay9rYXJwb3Ytd29yay9UcnVlTkFTL3dlYnVpL3NyYy9hcHAvbW9kdWxlcy9mb3Jtcy9peC1mb3Jtcy9jb21wb25lbnRzL2l4LXBlcm1pc3Npb25zL2l4LXBlcm1pc3Npb25zLmhhcm5lc3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQmFzZUhhcm5lc3NGaWx0ZXJzLCBDb21wb25lbnRIYXJuZXNzLCBIYXJuZXNzUHJlZGljYXRlLCBwYXJhbGxlbCxcbn0gZnJvbSAnQGFuZ3VsYXIvY2RrL3Rlc3RpbmcnO1xuaW1wb3J0IHsgTWF0Q2hlY2tib3hIYXJuZXNzIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvY2hlY2tib3gvdGVzdGluZyc7XG5pbXBvcnQgeyBQb3NpeFBlcm1pc3Npb24gfSBmcm9tICdhcHAvZW51bXMvcG9zaXgtYWNsLmVudW0nO1xuaW1wb3J0IHsgcGFyc2VNb2RlIH0gZnJvbSAnYXBwL2hlbHBlcnMvbW9kZS5oZWxwZXInO1xuaW1wb3J0IHsgSXhMYWJlbEhhcm5lc3MgfSBmcm9tICdhcHAvbW9kdWxlcy9mb3Jtcy9peC1mb3Jtcy9jb21wb25lbnRzL2l4LWxhYmVsL2l4LWxhYmVsLmhhcm5lc3MnO1xuaW1wb3J0IHsgSXhGb3JtQ29udHJvbEhhcm5lc3MgfSBmcm9tICdhcHAvbW9kdWxlcy9mb3Jtcy9peC1mb3Jtcy9pbnRlcmZhY2VzL2l4LWZvcm0tY29udHJvbC1oYXJuZXNzLmludGVyZmFjZSc7XG5pbXBvcnQgeyBnZXRFcnJvclRleHQgfSBmcm9tICdhcHAvbW9kdWxlcy9mb3Jtcy9peC1mb3Jtcy91dGlscy9oYXJuZXNzLnV0aWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBJeFBlcm1pc3Npb25zSGFybmVzc0ZpbHRlcnMgZXh0ZW5kcyBCYXNlSGFybmVzc0ZpbHRlcnMge1xuICBsYWJlbDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgSXhQZXJtaXNzaW9uc0hhcm5lc3MgZXh0ZW5kcyBDb21wb25lbnRIYXJuZXNzIGltcGxlbWVudHMgSXhGb3JtQ29udHJvbEhhcm5lc3Mge1xuICBzdGF0aWMgcmVhZG9ubHkgaG9zdFNlbGVjdG9yID0gJ2l4LXBlcm1pc3Npb25zJztcblxuICBzdGF0aWMgd2l0aChvcHRpb25zOiBJeFBlcm1pc3Npb25zSGFybmVzc0ZpbHRlcnMpOiBIYXJuZXNzUHJlZGljYXRlPEl4UGVybWlzc2lvbnNIYXJuZXNzPiB7XG4gICAgcmV0dXJuIG5ldyBIYXJuZXNzUHJlZGljYXRlKEl4UGVybWlzc2lvbnNIYXJuZXNzLCBvcHRpb25zKVxuICAgICAgLmFkZE9wdGlvbignbGFiZWwnLCBvcHRpb25zLmxhYmVsLCAoaGFybmVzcywgbGFiZWwpID0+IEhhcm5lc3NQcmVkaWNhdGUuc3RyaW5nTWF0Y2hlcyhoYXJuZXNzLmdldExhYmVsVGV4dCgpLCBsYWJlbCkpO1xuICB9XG5cbiAgZ2V0TWF0Q2hlY2tib3hIYXJuZXNzZXMgPSB0aGlzLmxvY2F0b3JGb3JBbGwoTWF0Q2hlY2tib3hIYXJuZXNzKTtcbiAgZ2V0RXJyb3JUZXh0ID0gZ2V0RXJyb3JUZXh0O1xuXG4gIGFzeW5jIGdldExhYmVsVGV4dCgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGxhYmVsID0gYXdhaXQgdGhpcy5sb2NhdG9yRm9yT3B0aW9uYWwoSXhMYWJlbEhhcm5lc3MpKCk7XG4gICAgaWYgKCFsYWJlbCkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gbGFiZWwuZ2V0TGFiZWwoKTtcbiAgfVxuXG4gIGFzeW5jIGdldFZhbHVlKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcGVybWlzc2lvbnMgPSAoYXdhaXQgdGhpcy5nZXRNYXRDaGVja2JveEhhcm5lc3NlcygpKTtcbiAgICBsZXQgb3duZXIgPSAwO1xuICAgIGxldCBncnAgPSAwO1xuICAgIGxldCBvdGhlciA9IDA7XG5cbiAgICBpZiAoKGF3YWl0IHBlcm1pc3Npb25zWzBdLmlzQ2hlY2tlZCgpKSkge1xuICAgICAgb3duZXIgKz0gNDtcbiAgICB9XG5cbiAgICBpZiAoKGF3YWl0IHBlcm1pc3Npb25zWzFdLmlzQ2hlY2tlZCgpKSkge1xuICAgICAgb3duZXIgKz0gMjtcbiAgICB9XG5cbiAgICBpZiAoKGF3YWl0IHBlcm1pc3Npb25zWzJdLmlzQ2hlY2tlZCgpKSkge1xuICAgICAgb3duZXIgKz0gMTtcbiAgICB9XG5cbiAgICBpZiAoKGF3YWl0IHBlcm1pc3Npb25zWzNdLmlzQ2hlY2tlZCgpKSkge1xuICAgICAgZ3JwICs9IDQ7XG4gICAgfVxuXG4gICAgaWYgKChhd2FpdCBwZXJtaXNzaW9uc1s0XS5pc0NoZWNrZWQoKSkpIHtcbiAgICAgIGdycCArPSAyO1xuICAgIH1cblxuICAgIGlmICgoYXdhaXQgcGVybWlzc2lvbnNbNV0uaXNDaGVja2VkKCkpKSB7XG4gICAgICBncnAgKz0gMTtcbiAgICB9XG5cbiAgICBpZiAocGVybWlzc2lvbnMubGVuZ3RoID4gNikge1xuICAgICAgaWYgKChhd2FpdCBwZXJtaXNzaW9uc1s2XS5pc0NoZWNrZWQoKSkpIHtcbiAgICAgICAgb3RoZXIgKz0gNDtcbiAgICAgIH1cblxuICAgICAgaWYgKChhd2FpdCBwZXJtaXNzaW9uc1s3XS5pc0NoZWNrZWQoKSkpIHtcbiAgICAgICAgb3RoZXIgKz0gMjtcbiAgICAgIH1cblxuICAgICAgaWYgKChhd2FpdCBwZXJtaXNzaW9uc1s4XS5pc0NoZWNrZWQoKSkpIHtcbiAgICAgICAgb3RoZXIgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG93bmVyLnRvU3RyaW5nKCkgKyBncnAudG9TdHJpbmcoKSArIG90aGVyLnRvU3RyaW5nKCkpO1xuICB9XG5cbiAgYXN5bmMgc2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNoZWNrYm94ZXMgPSAoYXdhaXQgdGhpcy5nZXRNYXRDaGVja2JveEhhcm5lc3NlcygpKTtcblxuICAgIGNvbnN0IHBlcm1pc3Npb25zID0gcGFyc2VNb2RlKHZhbHVlKTtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgcGVybWlzc2lvbnMub3duZXJbUG9zaXhQZXJtaXNzaW9uLlJlYWRdID8gY2hlY2tib3hlc1swXS5jaGVjaygpIDogY2hlY2tib3hlc1swXS51bmNoZWNrKCksXG4gICAgICBwZXJtaXNzaW9ucy5vd25lcltQb3NpeFBlcm1pc3Npb24uV3JpdGVdID8gY2hlY2tib3hlc1sxXS5jaGVjaygpIDogY2hlY2tib3hlc1sxXS51bmNoZWNrKCksXG4gICAgICBwZXJtaXNzaW9ucy5vd25lcltQb3NpeFBlcm1pc3Npb24uRXhlY3V0ZV0gPyBjaGVja2JveGVzWzJdLmNoZWNrKCkgOiBjaGVja2JveGVzWzJdLnVuY2hlY2soKSxcbiAgICAgIHBlcm1pc3Npb25zLmdyb3VwW1Bvc2l4UGVybWlzc2lvbi5SZWFkXSA/IGNoZWNrYm94ZXNbM10uY2hlY2soKSA6IGNoZWNrYm94ZXNbM10udW5jaGVjaygpLFxuICAgICAgcGVybWlzc2lvbnMuZ3JvdXBbUG9zaXhQZXJtaXNzaW9uLldyaXRlXSA/IGNoZWNrYm94ZXNbNF0uY2hlY2soKSA6IGNoZWNrYm94ZXNbNF0udW5jaGVjaygpLFxuICAgICAgcGVybWlzc2lvbnMuZ3JvdXBbUG9zaXhQZXJtaXNzaW9uLkV4ZWN1dGVdID8gY2hlY2tib3hlc1s1XS5jaGVjaygpIDogY2hlY2tib3hlc1s1XS51bmNoZWNrKCksXG4gICAgICBwZXJtaXNzaW9ucy5vdGhlcltQb3NpeFBlcm1pc3Npb24uUmVhZF0gPyBjaGVja2JveGVzWzZdLmNoZWNrKCkgOiBjaGVja2JveGVzWzZdLnVuY2hlY2soKSxcbiAgICAgIHBlcm1pc3Npb25zLm90aGVyW1Bvc2l4UGVybWlzc2lvbi5Xcml0ZV0gPyBjaGVja2JveGVzWzddLmNoZWNrKCkgOiBjaGVja2JveGVzWzddLnVuY2hlY2soKSxcbiAgICAgIHBlcm1pc3Npb25zLm90aGVyW1Bvc2l4UGVybWlzc2lvbi5FeGVjdXRlXSA/IGNoZWNrYm94ZXNbOF0uY2hlY2soKSA6IGNoZWNrYm94ZXNbOF0udW5jaGVjaygpLFxuICAgIF0pLnRoZW4oKCkgPT4ge30pO1xuICB9XG5cbiAgYXN5bmMgaXNEaXNhYmxlZCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBjaGVja2JveGVzID0gYXdhaXQgdGhpcy5nZXRNYXRDaGVja2JveEhhcm5lc3NlcygpO1xuICAgIGNvbnN0IGlucHV0U3RhdGUgPSBhd2FpdCBwYXJhbGxlbCgoKSA9PiBjaGVja2JveGVzLm1hcCgoY29udHJvbCkgPT4gY29udHJvbC5pc0Rpc2FibGVkKCkpKTtcblxuICAgIHJldHVybiBpbnB1dFN0YXRlLmV2ZXJ5KChjb250cm9sKSA9PiAhIWNvbnRyb2wpO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=