{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/network/components/static-route-form/static-route-form.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/network/components/static-route-form/static-route-form.component.ts"],"sourcesContent":["import {\n  ChangeDetectionStrategy, ChangeDetectorRef, Component, Inject, OnInit,\n} from '@angular/core';\nimport { FormBuilder, Validators, ReactiveFormsModule } from '@angular/forms';\nimport { MatButton } from '@angular/material/button';\nimport { MatCard, MatCardContent } from '@angular/material/card';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { TranslateService, TranslateModule } from '@ngx-translate/core';\nimport { Observable } from 'rxjs';\nimport { RequiresRolesDirective } from 'app/directives/requires-roles/requires-roles.directive';\nimport { WarnAboutUnsavedChangesDirective } from 'app/directives/warn-about-unsaved-changes/warn-about-unsaved-changes.directive';\nimport { Role } from 'app/enums/role.enum';\nimport { helptextStaticRoutes } from 'app/helptext/network/static-routes/static-routes';\nimport { StaticRoute, UpdateStaticRoute } from 'app/interfaces/static-route.interface';\nimport { FormActionsComponent } from 'app/modules/forms/ix-forms/components/form-actions/form-actions.component';\nimport { IxFieldsetComponent } from 'app/modules/forms/ix-forms/components/ix-fieldset/ix-fieldset.component';\nimport { IxInputComponent } from 'app/modules/forms/ix-forms/components/ix-input/ix-input.component';\nimport { IxModalHeaderComponent } from 'app/modules/forms/ix-forms/components/ix-slide-in/components/ix-modal-header/ix-modal-header.component';\nimport { IxSlideInRef } from 'app/modules/forms/ix-forms/components/ix-slide-in/ix-slide-in-ref';\nimport { SLIDE_IN_DATA } from 'app/modules/forms/ix-forms/components/ix-slide-in/ix-slide-in.token';\nimport { FormErrorHandlerService } from 'app/modules/forms/ix-forms/services/form-error-handler.service';\nimport { ipv4or6Validator } from 'app/modules/forms/ix-forms/validators/ip-validation';\nimport { SnackbarService } from 'app/modules/snackbar/services/snackbar.service';\nimport { TestDirective } from 'app/modules/test-id/test.directive';\nimport { WebSocketService } from 'app/services/ws.service';\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-static-route-form',\n  templateUrl: './static-route-form.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    IxModalHeaderComponent,\n    MatCard,\n    MatCardContent,\n    ReactiveFormsModule,\n    IxFieldsetComponent,\n    IxInputComponent,\n    FormActionsComponent,\n    RequiresRolesDirective,\n    MatButton,\n    TestDirective,\n    TranslateModule,\n    WarnAboutUnsavedChangesDirective,\n  ],\n})\nexport class StaticRouteFormComponent implements OnInit {\n  protected readonly requiredRoles = [Role.FullAdmin];\n\n  get isNew(): boolean {\n    return !this.editingRoute;\n  }\n\n  get title(): string {\n    return this.isNew ? this.translate.instant('Add Static Route') : this.translate.instant('Edit Static Route');\n  }\n\n  isFormLoading = false;\n\n  form = this.fb.group({\n    destination: ['', [Validators.required]],\n    gateway: ['', [Validators.required, ipv4or6Validator()]],\n    description: [''],\n  });\n\n  readonly tooltips = {\n    destination: helptextStaticRoutes.sr_destination_tooltip,\n    gateway: helptextStaticRoutes.sr_gateway_tooltip,\n    description: helptextStaticRoutes.sr_description_tooltip,\n  };\n\n  constructor(\n    private fb: FormBuilder,\n    private ws: WebSocketService,\n    private cdr: ChangeDetectorRef,\n    private snackbar: SnackbarService,\n    private errorHandler: FormErrorHandlerService,\n    private translate: TranslateService,\n    private slideInRef: IxSlideInRef<StaticRouteFormComponent>,\n    @Inject(SLIDE_IN_DATA) private editingRoute: StaticRoute,\n  ) {}\n\n  ngOnInit(): void {\n    if (this.editingRoute) {\n      this.setEditingStaticRoute();\n    }\n  }\n\n  setEditingStaticRoute(): void {\n    this.form.patchValue(this.editingRoute);\n  }\n\n  onSubmit(): void {\n    this.isFormLoading = true;\n    const values = this.form.value as UpdateStaticRoute;\n\n    let request$: Observable<unknown>;\n    if (this.isNew) {\n      request$ = this.ws.call('staticroute.create', [values]);\n    } else {\n      request$ = this.ws.call('staticroute.update', [\n        this.editingRoute.id,\n        values,\n      ]);\n    }\n\n    request$.pipe(untilDestroyed(this)).subscribe({\n      next: () => {\n        if (this.isNew) {\n          this.snackbar.success(this.translate.instant('Static route added'));\n        } else {\n          this.snackbar.success(this.translate.instant('Static route updated'));\n        }\n        this.isFormLoading = false;\n        this.cdr.markForCheck();\n        this.slideInRef.close(true);\n      },\n      error: (error: unknown) => {\n        this.isFormLoading = false;\n        this.cdr.markForCheck();\n        this.errorHandler.handleWsFormError(error, this.form);\n      },\n    });\n  }\n}\n"],"version":3}