{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/services/download.service.ts","mappings":";;;;;;;;;AAAA,+CAAkD;AAClD,wCAA2C;AAE3C,8CAA0C;AAKnC,IAAM,eAAe,GAArB,MAAM,eAAe;IAC1B,YAAsB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IAAG,CAAC;IAE1C,YAAY,CAAC,QAAgB,EAAE,QAAgB,EAAE,QAAQ,GAAG,YAAY;QACtE,MAAM,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;QAEtC,MAAM,WAAW,GAAG,IAAI,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;QACrD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YAC/C,WAAW,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAChD,CAAC;QAED,MAAM,SAAS,GAAG,IAAI,UAAU,CAAC,WAAW,CAAC,CAAC;QAE9C,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,SAAS,CAAC,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;QAEvD,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED,YAAY,CAAC,QAAgB,EAAE,QAAgB;QAC7C,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC,CAAC;QAC1D,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED,YAAY,CAAC,IAAU,EAAE,QAAgB;QACvC,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;QAC3C,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAClC,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC3B,MAAM,CAAC,IAAI,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QACxC,MAAM,CAAC,OAAO,GAAG,GAAG,EAAE;YACpB,iDAAiD;YACjD,UAAU,CAAC,GAAG,EAAE;gBACd,GAAG,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YACnC,CAAC,EAAE,IAAI,CAAC,CAAC;QACX,CAAC,CAAC;QAEF,MAAM,CAAC,KAAK,EAAE,CAAC;QACf,MAAM,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,kBAAkB,CAAC,GAAW,EAAE,QAAgB,EAAE,QAAgB;QAChE,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,YAAY,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,CAC3D,IAAA,eAAG,EACD,CAAC,IAAI,EAAE,EAAE;YACP,OAAO,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;QAC9C,CAAC,CACF,CACF,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,GAAW,EAAE,QAAgB,EAAE,QAAgB;QACzD,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC,IAAI,CAC1D,IAAA,eAAG,EAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,CACjD,CAAC;IACJ,CAAC;;AArDU,0CAAe;;;;0BAAf,eAAe;IAH3B,IAAA,iBAAU,EAAC;QACV,UAAU,EAAE,MAAM;KACnB,CAAC;GACW,eAAe,CAsD3B","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/services/download.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { map, tap } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class DownloadService {\n  constructor(protected http: HttpClient) {}\n\n  downloadFile(filename: string, contents: string, mimeType = 'text/plain'): void {\n    const byteCharacters = atob(contents);\n\n    const byteNumbers = new Array(byteCharacters.length);\n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n\n    const byteArray = new Uint8Array(byteNumbers);\n\n    const blob = new Blob([byteArray], { type: mimeType });\n\n    this.downloadBlob(blob, filename);\n  }\n\n  downloadText(contents: string, filename: string): void {\n    const blob = new Blob([contents], { type: 'text/plain' });\n    this.downloadBlob(blob, filename);\n  }\n\n  downloadBlob(blob: Blob, filename: string): void {\n    const anchor = document.createElement('a');\n    document.body.appendChild(anchor);\n    anchor.download = filename;\n    anchor.href = URL.createObjectURL(blob);\n    anchor.onclick = () => {\n      // revokeObjectURL needs a delay to work properly\n      setTimeout(() => {\n        URL.revokeObjectURL(anchor.href);\n      }, 1500);\n    };\n\n    anchor.click();\n    anchor.remove();\n  }\n\n  streamDownloadFile(url: string, filename: string, mimeType: string): Observable<Blob> {\n    return this.http.post(url, '', { responseType: 'blob' }).pipe(\n      map(\n        (blob) => {\n          return new Blob([blob], { type: mimeType });\n        },\n      ),\n    );\n  }\n\n  downloadUrl(url: string, filename: string, mimeType: string): Observable<Blob> {\n    return this.streamDownloadFile(url, filename, mimeType).pipe(\n      tap((blob) => this.downloadBlob(blob, filename)),\n    );\n  }\n}\n"],"version":3}