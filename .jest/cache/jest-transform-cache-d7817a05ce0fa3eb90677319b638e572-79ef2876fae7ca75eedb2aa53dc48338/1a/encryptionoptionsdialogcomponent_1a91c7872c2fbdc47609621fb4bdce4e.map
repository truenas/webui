{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/datasets/modules/encryption/components/encryption-options-dialog/encryption-options-dialog.component.ts","mappings":";;;;;;;;;AAAA,wCAEuB;AACvB,0CAA4C;AAC5C,qDAAyE;AACzE,2DAAqD;AACrD,yDAAqE;AACrE,8CAAuD;AACvD,+BAAwC;AACxC,8CAAqC;AACrC,qFAA2E;AAC3E,mDAA2C;AAC3C,qGAAwF;AACxF,qFAAyF;AAIzF,sEAAkE;AAClE,+GAAyG;AACzG,uHAAuH;AACvH,qFAA0E;AAC1E,8EAAyE;AACzE,qFAAiF;AACjF,0EAA+F;AAC/F,8EAAyE;AACzE,wDAA2D;AAC3D,yGAAyF;AAEzF,IAAK,cAGJ;AAHD,WAAK,cAAc;IACjB,6BAAW,CAAA;IACX,2CAAyB,CAAA;AAC3B,CAAC,EAHI,cAAc,KAAd,cAAc,QAGlB;AAWM,IAAM,gCAAgC,GAAtC,MAAM,gCAAgC;IAuC3C,YACU,EAAe,EACf,EAAoB,EACpB,SAA2B,EAC3B,MAAwB,EACxB,MAAqB,EACrB,SAAyD,EACzD,gBAAyC,EACzC,YAAiC,EACjC,QAAyB,EACD,IAAiC;QATzD,OAAE,GAAF,EAAE,CAAa;QACf,OAAE,GAAF,EAAE,CAAkB;QACpB,cAAS,GAAT,SAAS,CAAkB;QAC3B,WAAM,GAAN,MAAM,CAAkB;QACxB,WAAM,GAAN,MAAM,CAAe;QACrB,cAAS,GAAT,SAAS,CAAgD;QACzD,qBAAgB,GAAhB,gBAAgB,CAAyB;QACzC,iBAAY,GAAZ,YAAY,CAAqB;QACjC,aAAQ,GAAR,QAAQ,CAAiB;QACD,SAAI,GAAJ,IAAI,CAA6B;QAhDnE,SAAI,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;YACnB,kBAAkB,EAAE,CAAC,KAAK,CAAC;YAC3B,eAAe,EAAE,CAAC,IAAsB,CAAC;YACzC,YAAY,EAAE,CAAC,KAAK,CAAC;YACrB,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,kBAAU,CAAC,QAAQ,EAAE,kBAAU,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,kBAAU,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;YACpF,UAAU,EAAE,CAAC,EAAE,EAAE,kBAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YACzC,kBAAkB,EAAE,CAAC,EAAE,CAAC;YACxB,WAAW,EAAE,CAAC,MAAM,EAAE,kBAAU,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC7C,SAAS,EAAE,CAAC,EAAE,CAAC;YACf,OAAO,EAAE,CAAC,KAAK,EAAE,CAAC,kBAAU,CAAC,YAAY,CAAC,CAAC;SAC5C,EAAE;YACD,UAAU,EAAE;gBACV,IAAA,4CAAsB,EACpB,oBAAoB,EACpB,CAAC,YAAY,CAAC,EACd,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,2CAA2C,CAAC,CACpE;aACF;SACF,CAAC,CAAC;QAEH,kBAAa,GAAmB,EAAE,CAAC;QAEnC,kBAAa,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC;QACxE,WAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,eAAe,KAAK,cAAc,CAAC,GAAG,CAAC,CAAC;QACrF,wBAAmB,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;QAE/D,aAAQ,GAAG;YAClB,eAAe,EAAE,kCAAmB,CAAC,uBAAuB,CAAC,uBAAuB;YACpF,YAAY,EAAE,kCAAmB,CAAC,uBAAuB,CAAC,6BAA6B;YACvF,GAAG,EAAE,kCAAmB,CAAC,uBAAuB,CAAC,WAAW;YAC5D,UAAU,EAAE,kCAAmB,CAAC,uBAAuB,CAAC,kBAAkB;YAC1E,WAAW,EAAE,kCAAmB,CAAC,uBAAuB,CAAC,mBAAmB;SAC7E,CAAC;QAEO,2BAAsB,GAAG,IAAA,SAAE,EAAC,kCAAmB,CAAC,uBAAuB,CAAC,uBAAuB,CAAC,CAAC;QAEvF,SAAI,GAAG,gBAAI,CAAC;IAa5B,CAAC;IAEJ,IAAI,UAAU;;QACZ,OAAO,MAAA,IAAI,CAAC,IAAI,CAAC,MAAM,0CAAE,SAAS,CAAC;IACrC,CAAC;IAED,IAAI,mBAAmB;;QACrB,OAAO,CAAA,MAAA,MAAA,IAAI,CAAC,IAAI,CAAC,MAAM,0CAAE,UAAU,0CAAE,KAAK,MAAK,gDAAmB,CAAC,UAAU,CAAC;IAChF,CAAC;IAED,IAAI,WAAW;QACb,MAAM,QAAQ,GAAG,IAAA,+BAAU,EACzB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAC1B,CAAC,OAAO,EAAE,EAAE,CAAC,IAAA,gCAAgB,EAAC,OAAO,CAAC,IAAI,CAAC,IAAA,mCAAmB,EAAC,OAAO,CAAC,CACxE,CAAC;QAEF,OAAO,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC3B,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAChC,CAAC;IAED,QAAQ;QACN,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,kBAAkB,EAAE,CAAC;YACvC,4DAA4D;YAC5D,IAAI,CAAC,IAAA,gCAAgB,EAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC;gBACzC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBAC5B,OAAO;YACT,CAAC;YAED,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,QAAQ,EAAE,CAAC;QAClB,CAAC;IACH,CAAC;IAEO,YAAY;QAClB,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,mDAAmD,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;aACtF,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,IAAA,8BAAc,EAAC,IAAI,CAAC,CAAC;aACpD,SAAS,CAAC;YACT,IAAI,EAAE,GAAG,EAAE;gBACT,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAC1B,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC7B,CAAC;YACD,KAAK,EAAE,CAAC,KAAqB,EAAE,EAAE;gBAC/B,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;YAC5D,CAAC;SACF,CAAC,CAAC;IACP,CAAC;IAEO,QAAQ;QACd,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QAEvC,MAAM,IAAI,GAAG,EAA4B,CAAC;QAC1C,IAAI,MAAM,CAAC,eAAe,KAAK,cAAc,CAAC,GAAG,EAAE,CAAC;YAClD,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,YAAY,CAAC;YACxC,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;gBACzB,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC;YACxB,CAAC;QACH,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;YACpC,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAChD,CAAC;QAED,IAAI,CAAC,MAAM,CAAC,SAAS,CACnB,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,yBAAyB,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,EACpE,EAAE,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,mBAAmB,CAAC,EAAE,CACvD;aACE,WAAW,EAAE;aACb,IAAI,CAAC,IAAA,8BAAc,EAAC,IAAI,CAAC,CAAC;aAC1B,SAAS,CAAC;YACT,IAAI,EAAE,GAAG,EAAE;gBACT,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAC1B,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC7B,CAAC;YACD,KAAK,EAAE,CAAC,KAAqB,EAAE,EAAE;gBAC/B,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;YAC5D,CAAC;SACF,CAAC,CAAC;IACP,CAAC;IAEO,kBAAkB;QACxB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,0BAA0B,CAAC,CAAC,CAAC;IAC5E,CAAC;IAEO,eAAe;QACrB,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;aACtE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,IAAA,8BAAc,EAAC,IAAI,CAAC,CAAC;aACpD,SAAS,CAAC;YACT,IAAI,EAAE,CAAC,QAAmB,EAAE,EAAE;gBAC5B,MAAM,WAAW,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;gBAE5C,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,QAAQ,KAAK,GAAG,EAAE,CAAC;oBACjD,OAAO;gBACT,CAAC;gBAED,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC;oBACnB,WAAW,EAAE,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC;iBAC1C,CAAC,CAAC;YACL,CAAC;YACD,KAAK,EAAE,CAAC,KAAc,EAAE,EAAE;gBACxB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;YACzD,CAAC;SACF,CAAC,CAAC;IACP,CAAC;IAEO,aAAa;;QACnB,IAAI,cAAc,GAAG,cAAc,CAAC,UAAU,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC9B,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,cAAc,GAAG,cAAc,CAAC,GAAG,CAAC;YACtC,CAAC;iBAAM,CAAC;gBACN,cAAc,GAAG,IAAA,mCAAmB,EAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC;YAC3G,CAAC;QACH,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC;YACnB,kBAAkB,EAAE,CAAC,IAAA,gCAAgB,EAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;YACxD,SAAS,EAAE,CAAA,MAAA,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,oBAAoB,0CAAE,KAAK,KAAI,EAAE;YAC9D,eAAe,EAAE,cAAc;SAChC,CAAC,CAAC;IACL,CAAC;IAEO,sBAAsB;QAC5B,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;QAEvC,IAAI,IAAI,CAAC,mBAAmB,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;YACjD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;QAC/C,CAAC;QAED,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC,IAAA,iDAAkB,EAAC;YACtD,IAAI,CAAC,mBAAmB;YACxB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAA,eAAG,EAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;YACxC,IAAI,CAAC,aAAa;SACnB,CAAC,CAAC,CACJ,CAAC;QAEF,MAAM,4BAA4B,GAAG,IAAA,iDAAkB,EAAC,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;QAC3F,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,aAAa,CAAC,4BAA4B,CAAC,EACzE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,aAAa,CAAC,4BAA4B,CAAC,EACjF,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,aAAa,CAAC,4BAA4B,CAAC,CAC3E,CAAC;IACJ,CAAC;;AArMU,4EAAgC;;;;;;;;;;;yGAiDxC,aAAM,SAAC,wBAAe;;2CAjDd,gCAAgC;IAT5C,IAAA,4BAAY,EAAC;QACZ,SAAS,EAAE,eAAe;KAC3B,CAAC;IACD,IAAA,gBAAS,EAAC;QACT,QAAQ,EAAE,8BAA8B;QACxC,+DAAyD;QAEzD,eAAe,EAAE,8BAAuB,CAAC,MAAM;KAChD,CAAC;GACW,gCAAgC,CAsM5C","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/datasets/modules/encryption/components/encryption-options-dialog/encryption-options-dialog.component.ts"],"sourcesContent":["import {\n  ChangeDetectionStrategy, Component, Inject, OnInit,\n} from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormBuilder } from '@ngneat/reactive-forms';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { TranslateService } from '@ngx-translate/core';\nimport { of, Subscription } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { EncryptionKeyFormat } from 'app/enums/encryption-key-format.enum';\nimport { Role } from 'app/enums/role.enum';\nimport { combineLatestIsAny } from 'app/helpers/operators/combine-latest-is-any.helper';\nimport { helptextDatasetForm } from 'app/helptext/storage/volumes/datasets/dataset-form';\nimport { DatasetChangeKeyParams } from 'app/interfaces/dataset-change-key.interface';\nimport { Dataset } from 'app/interfaces/dataset.interface';\nimport { WebSocketError } from 'app/interfaces/websocket-error.interface';\nimport { DialogService } from 'app/modules/dialog/dialog.service';\nimport { FormErrorHandlerService } from 'app/modules/forms/ix-forms/services/form-error-handler.service';\nimport { matchOthersFgValidator } from 'app/modules/forms/ix-forms/validators/password-validation/password-validation';\nimport { findInTree } from 'app/modules/ix-tree/utils/find-in-tree.utils';\nimport { AppLoaderService } from 'app/modules/loader/app-loader.service';\nimport { SnackbarService } from 'app/modules/snackbar/services/snackbar.service';\nimport { isPasswordEncrypted, isEncryptionRoot } from 'app/pages/datasets/utils/dataset.utils';\nimport { ErrorHandlerService } from 'app/services/error-handler.service';\nimport { WebSocketService } from 'app/services/ws.service';\nimport { EncryptionOptionsDialogData } from './encryption-options-dialog-data.interface';\n\nenum EncryptionType {\n  Key = 'key',\n  Passphrase = 'passphrase',\n}\n\n@UntilDestroy({\n  arrayName: 'subscriptions',\n})\n@Component({\n  selector: 'ix-encryption-options-dialog',\n  templateUrl: './encryption-options-dialog.component.html',\n  styleUrls: ['./encryption-options-dialog.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class EncryptionOptionsDialogComponent implements OnInit {\n  form = this.fb.group({\n    inherit_encryption: [false],\n    encryption_type: [null as EncryptionType],\n    generate_key: [false],\n    key: ['', [Validators.required, Validators.minLength(64), Validators.maxLength(64)]],\n    passphrase: ['', Validators.minLength(8)],\n    confirm_passphrase: [''],\n    pbkdf2iters: [350000, Validators.min(100000)],\n    algorithm: [''],\n    confirm: [false, [Validators.requiredTrue]],\n  }, {\n    validators: [\n      matchOthersFgValidator(\n        'confirm_passphrase',\n        ['passphrase'],\n        this.translate.instant('Passphrase and confirmation should match.'),\n      ),\n    ],\n  });\n\n  subscriptions: Subscription[] = [];\n\n  isInheriting$ = this.form.select((values) => values.inherit_encryption);\n  isKey$ = this.form.select((values) => values.encryption_type === EncryptionType.Key);\n  isSetToGenerateKey$ = this.form.select((values) => values.generate_key);\n\n  readonly tooltips = {\n    encryption_type: helptextDatasetForm.dataset_form_encryption.encryption_type_tooltip,\n    generate_key: helptextDatasetForm.dataset_form_encryption.generate_key_checkbox_tooltip,\n    key: helptextDatasetForm.dataset_form_encryption.key_tooltip,\n    passphrase: helptextDatasetForm.dataset_form_encryption.passphrase_tooltip,\n    pbkdf2iters: helptextDatasetForm.dataset_form_encryption.pbkdf2iters_tooltip,\n  };\n\n  readonly encryptionTypeOptions$ = of(helptextDatasetForm.dataset_form_encryption.encryption_type_options);\n\n  protected readonly Role = Role;\n\n  constructor(\n    private fb: FormBuilder,\n    private ws: WebSocketService,\n    private translate: TranslateService,\n    private loader: AppLoaderService,\n    private dialog: DialogService,\n    private dialogRef: MatDialogRef<EncryptionOptionsDialogComponent>,\n    private formErrorHandler: FormErrorHandlerService,\n    private errorHandler: ErrorHandlerService,\n    private snackbar: SnackbarService,\n    @Inject(MAT_DIALOG_DATA) public data: EncryptionOptionsDialogData,\n  ) {}\n\n  get canInherit(): boolean {\n    return this.data.parent?.encrypted;\n  }\n\n  get hasPassphraseParent(): boolean {\n    return this.data.parent?.key_format?.value === EncryptionKeyFormat.Passphrase;\n  }\n\n  get hasKeyChild(): boolean {\n    const keyChild = findInTree(\n      this.data.dataset.children,\n      (dataset) => isEncryptionRoot(dataset) && !isPasswordEncrypted(dataset),\n    );\n\n    return Boolean(keyChild);\n  }\n\n  ngOnInit(): void {\n    this.loadPbkdf2iters();\n    this.setFormValues();\n    this.setControlDependencies();\n  }\n\n  onSubmit(): void {\n    if (this.form.value.inherit_encryption) {\n      // Only try to change to inherit if not currently inheriting\n      if (!isEncryptionRoot(this.data.dataset)) {\n        this.dialogRef.close(false);\n        return;\n      }\n\n      this.setToInherit();\n    } else {\n      this.saveForm();\n    }\n  }\n\n  private setToInherit(): void {\n    this.ws.call('pool.dataset.inherit_parent_encryption_properties', [this.data.dataset.id])\n      .pipe(this.loader.withLoader(), untilDestroyed(this))\n      .subscribe({\n        next: () => {\n          this.showSuccessMessage();\n          this.dialogRef.close(true);\n        },\n        error: (error: WebSocketError) => {\n          this.formErrorHandler.handleWsFormError(error, this.form);\n        },\n      });\n  }\n\n  private saveForm(): void {\n    const values = this.form.getRawValue();\n\n    const body = {} as DatasetChangeKeyParams;\n    if (values.encryption_type === EncryptionType.Key) {\n      body.generate_key = values.generate_key;\n      if (!values.generate_key) {\n        body.key = values.key;\n      }\n    } else {\n      body.passphrase = values.passphrase;\n      body.pbkdf2iters = Number(values.pbkdf2iters);\n    }\n\n    this.dialog.jobDialog(\n      this.ws.job('pool.dataset.change_key', [this.data.dataset.id, body]),\n      { title: this.translate.instant('Updating key type') },\n    )\n      .afterClosed()\n      .pipe(untilDestroyed(this))\n      .subscribe({\n        next: () => {\n          this.showSuccessMessage();\n          this.dialogRef.close(true);\n        },\n        error: (error: WebSocketError) => {\n          this.formErrorHandler.handleWsFormError(error, this.form);\n        },\n      });\n  }\n\n  private showSuccessMessage(): void {\n    this.snackbar.success(this.translate.instant('Encryption Options Saved'));\n  }\n\n  private loadPbkdf2iters(): void {\n    this.ws.call('pool.dataset.query', [[['id', '=', this.data.dataset.id]]])\n      .pipe(this.loader.withLoader(), untilDestroyed(this))\n      .subscribe({\n        next: (datasets: Dataset[]) => {\n          const pbkdf2iters = datasets[0].pbkdf2iters;\n\n          if (!pbkdf2iters || pbkdf2iters.rawvalue === '0') {\n            return;\n          }\n\n          this.form.patchValue({\n            pbkdf2iters: Number(pbkdf2iters.rawvalue),\n          });\n        },\n        error: (error: unknown) => {\n          this.dialog.error(this.errorHandler.parseError(error));\n        },\n      });\n  }\n\n  private setFormValues(): void {\n    let encryptionType = EncryptionType.Passphrase;\n    if (!this.hasPassphraseParent) {\n      if (this.hasKeyChild) {\n        encryptionType = EncryptionType.Key;\n      } else {\n        encryptionType = isPasswordEncrypted(this.data.dataset) ? EncryptionType.Passphrase : EncryptionType.Key;\n      }\n    }\n\n    this.form.patchValue({\n      inherit_encryption: !isEncryptionRoot(this.data.dataset),\n      algorithm: this.data.dataset.encryption_algorithm?.value || '',\n      encryption_type: encryptionType,\n    });\n  }\n\n  private setControlDependencies(): void {\n    this.form.controls.algorithm.disable();\n\n    if (this.hasPassphraseParent || this.hasKeyChild) {\n      this.form.controls.encryption_type.disable();\n    }\n\n    this.subscriptions.push(\n      this.form.controls.key.disabledWhile(combineLatestIsAny([\n        this.isSetToGenerateKey$,\n        this.isKey$.pipe(map((value) => !value)),\n        this.isInheriting$,\n      ])),\n    );\n\n    const arePassphraseFieldsDisabled$ = combineLatestIsAny([this.isKey$, this.isInheriting$]);\n    this.subscriptions.push(\n      this.form.controls.passphrase.disabledWhile(arePassphraseFieldsDisabled$),\n      this.form.controls.confirm_passphrase.disabledWhile(arePassphraseFieldsDisabled$),\n      this.form.controls.pbkdf2iters.disabledWhile(arePassphraseFieldsDisabled$),\n    );\n  }\n}\n"],"version":3}