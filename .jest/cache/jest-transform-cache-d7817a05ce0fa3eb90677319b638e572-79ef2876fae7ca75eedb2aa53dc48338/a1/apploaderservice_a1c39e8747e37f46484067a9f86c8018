ac41e44d830a1f01fe0280dacfbdd004
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.AppLoaderService = void 0;
const core_1 = require("@angular/core");
const dialog_1 = require("@angular/material/dialog");
const ngx_translate_extract_marker_1 = require("@biesbjerg/ngx-translate-extract-marker");
const rxjs_1 = require("rxjs");
const app_loader_component_1 = require("app/modules/loader/components/app-loader/app-loader.component");
let AppLoaderService = class AppLoaderService {
    constructor(matDialog) {
        this.matDialog = matDialog;
    }
    /**
     * Opens loader when observable (request) starts and closes when it ends.
     */
    withLoader() {
        return (source$) => (0, rxjs_1.defer)(() => {
            this.open();
            return source$.pipe((0, rxjs_1.finalize)(() => this.close()));
        });
    }
    open(title = (0, ngx_translate_extract_marker_1.marker)('Please wait')) {
        if (this.dialogRef !== undefined) {
            return rxjs_1.EMPTY;
        }
        this.dialogRef = this.matDialog.open(app_loader_component_1.AppLoaderComponent, { disableClose: true });
        this.dialogRef.updateSize('200px', '200px');
        this.dialogRef.componentInstance.title = title;
        return this.dialogRef.afterClosed();
    }
    close() {
        if (this.dialogRef) {
            this.dialogRef.close();
            this.dialogRef = undefined;
        }
    }
    setTitle(title) {
        if (!this.dialogRef) {
            return;
        }
        this.dialogRef.componentInstance.title = title;
    }
};
exports.AppLoaderService = AppLoaderService;
AppLoaderService.ctorParameters = () => [
    { type: dialog_1.MatDialog }
];
exports.AppLoaderService = AppLoaderService = __decorate([
    (0, core_1.Injectable)({ providedIn: 'root' })
], AppLoaderService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hY2Jvb2sva2FycG92LXdvcmsvVHJ1ZU5BUy93ZWJ1aS9zcmMvYXBwL21vZHVsZXMvbG9hZGVyL2FwcC1sb2FkZXIuc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSx3Q0FBMkM7QUFDM0MscURBQW1FO0FBQ25FLDBGQUFzRTtBQUN0RSwrQkFFYztBQUNkLHdHQUFtRztBQUc1RixJQUFNLGdCQUFnQixHQUF0QixNQUFNLGdCQUFnQjtJQUczQixZQUFvQixTQUFvQjtRQUFwQixjQUFTLEdBQVQsU0FBUyxDQUFXO0lBQUksQ0FBQztJQUU3Qzs7T0FFRztJQUNILFVBQVU7UUFDUixPQUFPLENBQUMsT0FBc0IsRUFBRSxFQUFFLENBQUMsSUFBQSxZQUFLLEVBQUMsR0FBRyxFQUFFO1lBQzVDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNaLE9BQU8sT0FBTyxDQUFDLElBQUksQ0FDakIsSUFBQSxlQUFRLEVBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQzdCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxJQUFJLENBQUMsUUFBZ0IsSUFBQSxxQ0FBQyxFQUFDLGFBQWEsQ0FBQztRQUNuQyxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDakMsT0FBTyxZQUFLLENBQUM7UUFDZixDQUFDO1FBRUQsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyx5Q0FBa0IsRUFBRSxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ2pGLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDL0MsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3RDLENBQUM7SUFFRCxLQUFLO1FBQ0gsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDbkIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUN2QixJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUM3QixDQUFDO0lBQ0gsQ0FBQztJQUVELFFBQVEsQ0FBQyxLQUFhO1FBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDcEIsT0FBTztRQUNULENBQUM7UUFFRCxJQUFJLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDakQsQ0FBQzs7QUF6Q1UsNENBQWdCOzs7OzJCQUFoQixnQkFBZ0I7SUFENUIsSUFBQSxpQkFBVSxFQUFDLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxDQUFDO0dBQ3RCLGdCQUFnQixDQTBDNUIiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL21hY2Jvb2sva2FycG92LXdvcmsvVHJ1ZU5BUy93ZWJ1aS9zcmMvYXBwL21vZHVsZXMvbG9hZGVyL2FwcC1sb2FkZXIuc2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXREaWFsb2csIE1hdERpYWxvZ1JlZiB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQgeyBtYXJrZXIgYXMgVCB9IGZyb20gJ0BiaWVzYmplcmcvbmd4LXRyYW5zbGF0ZS1leHRyYWN0LW1hcmtlcic7XG5pbXBvcnQge1xuICBkZWZlciwgRU1QVFksIGZpbmFsaXplLCBNb25vVHlwZU9wZXJhdG9yRnVuY3Rpb24sIE9ic2VydmFibGUsXG59IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgQXBwTG9hZGVyQ29tcG9uZW50IH0gZnJvbSAnYXBwL21vZHVsZXMvbG9hZGVyL2NvbXBvbmVudHMvYXBwLWxvYWRlci9hcHAtbG9hZGVyLmNvbXBvbmVudCc7XG5cbkBJbmplY3RhYmxlKHsgcHJvdmlkZWRJbjogJ3Jvb3QnIH0pXG5leHBvcnQgY2xhc3MgQXBwTG9hZGVyU2VydmljZSB7XG4gIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPEFwcExvYWRlckNvbXBvbmVudD47XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBtYXREaWFsb2c6IE1hdERpYWxvZykgeyB9XG5cbiAgLyoqXG4gICAqIE9wZW5zIGxvYWRlciB3aGVuIG9ic2VydmFibGUgKHJlcXVlc3QpIHN0YXJ0cyBhbmQgY2xvc2VzIHdoZW4gaXQgZW5kcy5cbiAgICovXG4gIHdpdGhMb2FkZXI8VD4oKTogTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uPFQ+IHtcbiAgICByZXR1cm4gKHNvdXJjZSQ6IE9ic2VydmFibGU8VD4pID0+IGRlZmVyKCgpID0+IHtcbiAgICAgIHRoaXMub3BlbigpO1xuICAgICAgcmV0dXJuIHNvdXJjZSQucGlwZShcbiAgICAgICAgZmluYWxpemUoKCkgPT4gdGhpcy5jbG9zZSgpKSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH1cblxuICBvcGVuKHRpdGxlOiBzdHJpbmcgPSBUKCdQbGVhc2Ugd2FpdCcpKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgaWYgKHRoaXMuZGlhbG9nUmVmICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBFTVBUWTtcbiAgICB9XG5cbiAgICB0aGlzLmRpYWxvZ1JlZiA9IHRoaXMubWF0RGlhbG9nLm9wZW4oQXBwTG9hZGVyQ29tcG9uZW50LCB7IGRpc2FibGVDbG9zZTogdHJ1ZSB9KTtcbiAgICB0aGlzLmRpYWxvZ1JlZi51cGRhdGVTaXplKCcyMDBweCcsICcyMDBweCcpO1xuICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLnRpdGxlID0gdGl0bGU7XG4gICAgcmV0dXJuIHRoaXMuZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCk7XG4gIH1cblxuICBjbG9zZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5kaWFsb2dSZWYpIHtcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKCk7XG4gICAgICB0aGlzLmRpYWxvZ1JlZiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICBzZXRUaXRsZSh0aXRsZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmRpYWxvZ1JlZikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLnRpdGxlID0gdGl0bGU7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==