<div class="advanced-search">
  <span class="prefix-icon" [matTooltip]="errorMessages?.[0]?.message">
    @if (!queryInputValue) {
      <ix-icon name="mdi-text-search-variant"></ix-icon>
    } @else if (hasQueryErrors) {
      <ix-icon name="warning"></ix-icon>
    } @else {
      <ix-icon name="done"></ix-icon>
    }
  </span>

  <div #inputArea class="input-area" (focusin)="startSuggestionsCompletion()" (click)="startSuggestionsCompletion()">
    @if (showDatePicker$ | async) {
      <mat-card class="calendar">
        <mat-calendar (selectedChange)="dateSelected($event)"></mat-calendar>
      </mat-card>
    }
  </div>

  <span
    class="switch-link"
    ixTest="switch-to-basic"
    tabindex="0"
    [matTooltip]="'Switch To Basic' | translate"
    (click)="switchToBasic.emit()"
    (keydown.enter)="switchToBasic.emit()"
  >
    <ix-icon name="mdi-tune"></ix-icon>
    {{ 'Basic' | translate }}
  </span>

  <span
    class="reset-icon reset-input"
    [class.hidden]="!editorHasValue"
    (click)="onResetInput()" 
  >
    <ix-icon
      name="mdi-close-circle"
      tabindex="0"
      (keydown.enter)="$event.preventDefault(); onResetInput()"
    ></ix-icon>
  </span>
</div>

@if (filterPresets()?.length > 0) {
  <ix-filter-presets
    [presets]="filterPresets()"
    [selectedPresetLabels]="selectedPresetLabels()"
    (filtersChanged)="applyPreset($event.filters, $event.selectedLabels)"
  ></ix-filter-presets>
}
