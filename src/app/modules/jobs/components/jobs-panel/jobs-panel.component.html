<mat-dialog-content>
  <div class="jobs-header">
    <h3>{{ 'Running Jobs' | translate }}</h3>

    <div class="badges">
      <div
        class="job-badge running"
        [matTooltip]="'Active' | translate"
      >
        <span class="job-badge-count">{{ runningJobsCount$ | async }}</span>
        <tn-icon name="sync" library="mdi" class="job-icon-running"></tn-icon>
      </div>
      <div
        class="job-badge waiting"
        [matTooltip]="JobState.Waiting | jobStateDisplay"
      >
        <span class="job-badge-count">{{ waitingJobsCount$ | async }}</span>
        <tn-icon name="clock-outline" library="mdi" class="job-icon-waiting"></tn-icon>
      </div>
      <div
        class="job-badge success"
        [matTooltip]="JobState.Success | jobStateDisplay"
      >
        <span class="job-badge-count">{{ successJobsCount$ | async }}</span>
        <tn-icon name="check-circle" library="mdi" class="job-icon-success"></tn-icon>
      </div>
      <div
        class="job-badge failed"
        [matTooltip]="JobState.Failed | jobStateDisplay"
      >
        <span class="job-badge-count">{{ failedJobsCount$ | async }}</span>
        <tn-icon name="close-circle" library="mdi" class="job-icon-failed"></tn-icon>
      </div>
    </div>
  </div>

  @if (isLoading$ | async) {
    <div>
      <mat-progress-bar
        class="loading-indicator"
        color="primary"
        mode="indeterminate"
      ></mat-progress-bar>
    </div>
  } @else {
    @let jobs = ongoingJobs$ | async;
    @if (jobs?.length) {
      <div class="jobs-list">
        @for (job of jobs; track job.id) {
          <ix-job-item
            [job]="job"
            [clickable]="true"
            (aborted)="onAbort(job)"
            (opened)="openJobDialog(job)"
          ></ix-job-item>
        }
      </div>
    } @else {
      <div class="no-jobs">
        <tn-icon name="information" library="mdi"></tn-icon>
        <h4 class="message">{{ 'No jobs running.' | translate }}</h4>
      </div>
    }
    <mat-divider class="list-divider"></mat-divider>
    <div mat-subheader class="recent-header">{{'Recently Completed Jobs' | translate}}</div>
    <div class="finished-jobs-list">
      @let finishedJobs = finishedJobs$ | async;
      @for (job of finishedJobs; track job.id) {
        <ix-job-item
          [job]="job"
          [clickable]="true"
          (aborted)="onAbort(job)"
          (opened)="openJobDialog(job)"
        ></ix-job-item>
      }
    </div>
  }

  @if (error$ | async; as error) {
    <div class="error">
      <tn-icon name="close-circle" library="mdi" class="icon" color="accent"></tn-icon>
      <h4 class="message">
        <span class="error-word">{{ 'Error' | translate }}:</span>
        {{ error }}
      </h4>
    </div>
  }

</mat-dialog-content>

<mat-dialog-actions>
  <button
    mat-button
    ixTest="history"
    (click)="goToJobs()"
  >
    {{ 'View All Jobs' | translate }}
  </button>
</mat-dialog-actions>
