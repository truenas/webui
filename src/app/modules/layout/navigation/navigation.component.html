<mat-nav-list
  role="navigation"
  [attr.aria-label]="'Main menu' | translate"
>
  @for (item of menuItems; track item; let i = $index) {
    <div>
      @if (!item.isVisible$ || (item.isVisible$ | async)) {
        <!-- links and submenus -->
        <mat-list-item
          class="sidebar-list-item sidenav-link"
          role="listitem"
          [routerLinkActive]="item.type === MenuItemType.Link ? 'highlighted' : ''"
          [id]="'nav-' + i"
          [class.has-submenu]="item.type === MenuItemType.SlideOut"
          [class.highlighted]="item.type === MenuItemType.SlideOut && isSlideOutActive(item.state)"
        >
          @if (item.type === MenuItemType.Link) {
            @let badgeCount = getBadgeCount(item);
            <a
              matTooltipPosition="right"
              [ixTest]="getItemName(item)"
              [routerLink]="getRouterLink(item.state)"
              [name]="getItemName(item)"
              [matTooltip]="(isSidenavCollapsed() && item.tooltip) ? (item.tooltip | translate) : null"
              (click)="closeMenu()"
            >
              <tn-icon size="lg" [name]="item.icon"></tn-icon>
              <span class="menu-text">
                {{ item.name | translate }}
                @if (badgeCount > 0) {
                  <span
                    class="menu-badge-dot"
                    role="status"
                    [class.critical]="getBadgeType(item) === AlertBadgeType.Critical"
                    [class.warning]="getBadgeType(item) === AlertBadgeType.Warning"
                    [class.info]="getBadgeType(item) === AlertBadgeType.Info"
                    [matTooltip]="getBadgeTooltip(item) | translate"
                    [attr.aria-label]="getBadgeTooltip(item) | translate"
                  >
                    <ix-icon [name]="getBadgeIcon(item)"></ix-icon>
                  </span>
                }
              </span>
            </a>
          } @else if (item.type === MenuItemType.SlideOut) {
            @let badgeCount = getBadgeCount(item);
            <a
              tabindex="0"
              role="button"
              matTooltipPosition="right"
              [ixTest]="getItemName(item)"
              [name]="getItemName(item)"
              [attr.aria-expanded]="isMenuExpanded(item.state)"
              [attr.aria-label]="(item.name | translate) + ' submenu'"
              [matTooltip]="(isSidenavCollapsed() && item.tooltip) ? (item.tooltip | translate) : null"
              (click)="toggleMenu(item.state, item.sub || [])"
              (keydown.enter)="toggleMenu(item.state, item.sub || [])"
              (keydown.space)="$event.preventDefault(); toggleMenu(item.state, item.sub || [])"
              >
              <tn-icon size="lg" [name]="item.icon"></tn-icon>
              <span class="menu-text">
                {{ item.name | translate }}
                @if (badgeCount > 0) {
                  <span
                    class="menu-badge-dot"
                    role="status"
                    [class.critical]="getBadgeType(item) === AlertBadgeType.Critical"
                    [class.warning]="getBadgeType(item) === AlertBadgeType.Warning"
                    [class.info]="getBadgeType(item) === AlertBadgeType.Info"
                    [matTooltip]="getBadgeTooltip(item) | translate"
                    [attr.aria-label]="getBadgeTooltip(item) | translate"
                  >
                    <ix-icon [name]="getBadgeIcon(item)"></ix-icon>
                  </span>
                }
              </span>
              <tn-icon class="menu-caret" name="chevron-right" library="mdi" size="lg"></tn-icon>
            </a>
          }
        </mat-list-item>
      }
    </div>
  }
</mat-nav-list>
