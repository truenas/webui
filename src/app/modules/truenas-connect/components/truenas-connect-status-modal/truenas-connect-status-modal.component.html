<div mat-dialog-title class="dialog-title-with-logo">
  <a href="https://connect.truenas.com" target="_blank" rel="noopener noreferrer">
    <img class="title-logo" src="assets/images/truenas-connect-logo-horizontal.svg" alt="TrueNAS Connect" />
  </a>
</div>
<mat-divider></mat-divider>
<mat-dialog-content>
  @if (isLoading()) {
    <div class="loading-state-content">
      <ix-truenas-connect-spinner></ix-truenas-connect-spinner>
      <div class="loading-state-text">
        {{ "Initializing TrueNAS Connect service..." | translate }}
      </div>
    </div>
  } @else if (currentView() === ModalView.InterfaceSelector) {
    <ix-truenas-connect-interface-selector
      (interfacesSelected)="onInterfacesSelected($event)"
    ></ix-truenas-connect-interface-selector>
  } @else {
    <ix-truenas-connect-status-display
      [status]="TncStatus.Waiting"
      [rawStatus]="tnc.config()?.status"
      [tier]="tnc.config()?.tier"
    ></ix-truenas-connect-status-display>
  }
</mat-dialog-content>
<div mat-dialog-actions>
  @if (isLoading()) {
    <button mat-button ixTest="tnc-loading" [disabled]="true">
      {{ "Loading..." | translate }}
    </button>
  } @else if (currentView() === ModalView.InterfaceSelector) {
    <button
      color="primary"
      mat-button
      (click)="connect()"
    >
      @if (isConnecting()) {
        {{ "Connecting..." | translate }}
      } @else {
        {{ "Connect" | translate }}
      }
    </button>
  } @else if (status() === TncStatus.Active) {
    <button
      color="warn"
      mat-button
      ixTest="tnc-disable-service"
      [disabled]="isDisabling()"
      (click)="disableService()"
    >
      {{ "Disable" | translate }}
    </button>
    <button
      color="primary"
      mat-button
      ixTest="tnc-open"
      [disabled]="isDisabling()"
      (click)="open()"
    >
      {{ "Open TNC" | translate }}
    </button>
  } @else if (status() === TncStatus.Waiting) {
    <a
      href="https://connect.truenas.com/"
      target="_blank"
      rel="noopener noreferrer"
      ixTest="tnc-documentation-link"
      class="learn-more-button"
    >
      <button mat-button>
        {{ "Learn More" | translate }}
      </button>
    </a>
    <button
      color="primary"
      mat-button
      ixTest="tnc-get-connected"
      (click)="showInterfaceSelector()"
    >
      {{ "Get Connected" | translate }}
    </button>
  } @else if (status() === TncStatus.Failed) {
    <a
      href="https://connect.truenas.com/"
      target="_blank"
      rel="noopener noreferrer"
      ixTest="tnc-documentation-link-failed"
      class="learn-more-button"
    >
      <button mat-button>
        {{ "Learn More" | translate }}
      </button>
    </a>
    <button
      color="primary"
      mat-button
      ixTest="tnc-retry-connection"
      [disabled]="isRetrying()"
      (click)="retryConnection()"
    >
      @if (isRetrying()) {
        {{ "Retrying..." | translate }}
      } @else {
        {{ "Retry Connection" | translate }}
      }
    </button>
  } @else if (status() === TncStatus.Disabled) {
    <button
      color="primary"
      mat-button
      ixTest="tnc-enable-service"
      (click)="showInterfaceSelector()"
    >
      {{ "Enable Service" | translate }}
    </button>
  }
</div>
