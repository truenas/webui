<mat-card class="card">
  <ix-fake-progress-bar [loading]="isLoading$ | async"></ix-fake-progress-bar>
  <form (keydown.enter)="$event.preventDefault()">
    <mat-vertical-stepper #stepper>
      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.General)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.General)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.General)"
      >
        <ng-template matStepLabel>{{ 'General Info' | translate }}</ng-template>
        <ix-general-wizard-step
          [isStepActive]="activeStep === PoolCreationWizardStep.General"
          (stepStatusValidityChanged)="stepValidityChanged(PoolCreationWizardStep.General, $event)"
        ></ix-general-wizard-step>
      </mat-step>

      <mat-step
        *ngIf="hasEnclosureStep"
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.EnclosureOptions)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.EnclosureOptions)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.EnclosureOptions)"
      >
        <ng-template matStepLabel>{{ 'Enclosure Options' | translate }}</ng-template>
        <ix-enclosure-wizard-step
          [isStepActive]="activeStep === PoolCreationWizardStep.EnclosureOptions"
          (stepStatusValidityChanged)="stepValidityChanged(PoolCreationWizardStep.EnclosureOptions, $event)"
        ></ix-enclosure-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.Data)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.Data)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.Data)"
      >
        <ng-template matStepLabel>{{ 'Data' | translate }}</ng-template>
        <ix-data-wizard-step
          [isStepActive]="activeStep === PoolCreationWizardStep.Data"
          (stepStatusValidityChanged)="stepValidityChanged(PoolCreationWizardStep.Data, $event)"
          (goToLastStep)="goToLastStep()"
        ></ix-data-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.Log)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.Log)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.Log)"
      >
        <ng-template matStepLabel>{{ 'Log (Optional)' | translate }}</ng-template>
        <ix-log-wizard-step (goToLastStep)="goToLastStep()"></ix-log-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.Spare)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.Spare)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.Spare)"
      >
        <ng-template matStepLabel>{{ 'Spare (Optional)' | translate }}</ng-template>
        <ix-spare-wizard-step (goToLastStep)="goToLastStep()"></ix-spare-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.Cache)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.Cache)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.Cache)"
      >
        <ng-template matStepLabel>{{ 'Cache (Optional)' | translate }}</ng-template>
        <ix-cache-wizard-step (goToLastStep)="goToLastStep()"></ix-cache-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.Metadata)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.Metadata)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.Metadata)"
      >
        <ng-template matStepLabel>{{ 'Metadata (Optional)' | translate }}</ng-template>
        <ix-metadata-wizard-step (goToLastStep)="goToLastStep()"></ix-metadata-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        [errorMessage]="getPoolCreationStepErrors(PoolCreationWizardStep.Dedup)?.[0]?.text"
        [hasError]="!!getPoolCreationStepErrors(PoolCreationWizardStep.Dedup)?.length"
        (activate)="onStepActivated(PoolCreationWizardStep.Dedup)"
      >
        <ng-template matStepLabel>{{ 'Dedup (Optional)' | translate }}</ng-template>
        <ix-dedup-wizard-step (goToLastStep)="goToLastStep()"></ix-dedup-wizard-step>
      </mat-step>

      <mat-step
        ixStepActivation
        (activate)="onStepActivated(PoolCreationWizardStep.Review)"
      >
        <ng-template matStepLabel>{{ 'Review' | translate }}</ng-template>
        <ix-review-wizard-step
          [isStepActive]="activeStep === PoolCreationWizardStep.Review"
          (createPool)="createPool()"
        ></ix-review-wizard-step>
      </mat-step>
    </mat-vertical-stepper>
  </form>
</mat-card>
