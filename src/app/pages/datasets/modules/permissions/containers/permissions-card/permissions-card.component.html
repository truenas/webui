<mat-card class="card">
  <mat-card-header>
    <h3 mat-card-title>{{ 'Permissions' | translate }}</h3>

    <ng-container *ixRequiresRoles="requiredRoles">
      @if (canEditPermissions) {
        <button
          mat-button
          ixTest="edit-permissions"
          (click)="redirectToEditPermissions()"
        >
          {{ 'Edit' | translate }}
        </button>
      }
    </ng-container>
  </mat-card-header>

  <mat-card-content>
    <div *ngIf="stat?.user || isLoading" class="file-information">
      <div class="details-item">
        <div class="label">{{ 'Owner:' | translate }}</div>
        <div *ngIf="!isLoading; else loaderDetailsItem" class="value">
          {{ stat.user }}
        </div>
      </div>
      <div class="details-item">
        <div class="label">{{ 'Group:' | translate }}</div>
        <div *ngIf="!isLoading; else loaderDetailsItem" class="value">
          {{ stat.group }}
        </div>
      </div>
    </div>

    @if (acl) {
      <div class="permissions">
        @if (acl.trivial) {
          <ix-view-trivial-permissions
            [stat]="stat"
          ></ix-view-trivial-permissions>
        } @else {
          @switch (acl.acltype) {
            @case (AclType.Posix1e) {
              <ix-view-posix-permissions
                [acl]="acl | cast"
              ></ix-view-posix-permissions>
            }
            @case (AclType.Nfs4) {
              <ix-view-nfs-permissions
                [acl]="acl | cast"
              ></ix-view-nfs-permissions>
            }
          }
        }
      </div>
    }

    @if (!isLoading && !acl) {
      <ix-empty
        [conf]="isMissingMountpoint ? missionMountpointEmptyConfig : emptyConfig"
      ></ix-empty>
    }
  </mat-card-content>
</mat-card>

<ng-template #loaderDetailsItem>
  <ngx-skeleton-loader></ngx-skeleton-loader>
</ng-template>

@if (isLoading) {
  <div class="permissions loader-permissions">
    <ngx-skeleton-loader
      [count]="4"
    ></ngx-skeleton-loader>
  </div>
}

