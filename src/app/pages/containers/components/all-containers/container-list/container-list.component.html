<div class="table-header">
  @if (hasCheckedContainers) {
    <ix-container-list-bulk-actions
      [checkedContainers]="checkedContainers"
      (resetBulkSelection)="resetSelection()"
    ></ix-container-list-bulk-actions>
  }
</div>

<div class="item-search">
  <ix-fake-progress-bar
    class="loader-bar"
    [loading]="isLoading()"
  ></ix-fake-progress-bar>

  <ix-basic-search
    [query]="searchQuery()"
    (queryChange)="onListFiltered($event)"
  ></ix-basic-search>
</div>

@if (containers() !== undefined && !filteredContainers().length && !isLoading()) {
  <ix-empty [conf]="emptyConfig()"></ix-empty>
} @else {
  <div class="containers">
    <div class="containers-header-row">
      <div class="cell checkbox">
        @if (containers().length) {
          <mat-checkbox
            color="primary"
            ixTest="select-all-containers"
            [checked]="isAllSelected"
            [indeterminate]="!isAllSelected && !!selection.selected.length"
            [disabled]="filteredContainers().length === 0"
            (change)="toggleAllChecked($event.checked)"
          ></mat-checkbox>
        }
      </div>
      <div class="cell">{{ 'Name' | translate }}</div>
      <div class="cell">{{ 'Status' | translate }}</div>
      <div class="cell">{{ 'Autostart' | translate }}</div>
      <div class="cell">CPU</div>
      <div class="cell">RAM</div>
      <div class="cell">Disk I/O</div>
      <div class="cell actions">{{ 'Controls' | translate }}</div>
    </div>

    @for (container of filteredContainers(); track container.id) {
      <ix-container-row
        [container]="container"
        [metrics]="metrics()?.[container.id]"
        [class.selected]="selectedContainer()?.id === container.id"
        [selected]="selection.isSelected(container.id)"
        (click)="navigateToDetails(container)"
        (selectionChange)="selection.toggle(container.id)"
        (keydown.enter)="navigateToDetails(container)"
      ></ix-container-row>
    }
  </div>
}
