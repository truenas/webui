<ng-template #pageHeader>
  <ix-page-title-header [pageTitle]="pageTitle | titlecase">
    <ix-fake-progress-bar [loading]="isLoading$ | async"></ix-fake-progress-bar>
  </ix-page-title-header>
</ng-template>

<div fxLayout="row nowrap">
  <div fxFlex="70%">
    <section fxLayout="row">
      <ix-app-details-header
        [app]="app"
        [isLoading$]="isLoading$"
      ></ix-app-details-header>
    </section>

    <!-- TODO: https://ixsystems.atlassian.net/browse/NAS-121706 -->
    <section>
      <h2>{{ 'Screenshots' | translate }}</h2>
      <div fxLayout="row nowrap" fxLayoutGap="16px">
        <ng-container *ngIf="isLoading$ | async; else appScreenshots">
          <ngx-skeleton-loader fxFlex class="screenshot-loader"></ngx-skeleton-loader>
          <ngx-skeleton-loader fxFlex class="screenshot-loader"></ngx-skeleton-loader>
          <ngx-skeleton-loader fxFlex class="screenshot-loader"></ngx-skeleton-loader>
        </ng-container>

        <ng-template #appScreenshots>
          <div class="screenshot">
            <img
              alt="Logo image background of stars and sky at night"
              class="screenshot-image"
              src="assets/images/stars-sky-1200w.jpg"
              srcset="assets/images/stars-sky-400w.jpg, assets/images/stars-sky-800w.jpg 2x, assets/images/stars-sky-1200w.jpg 3x">
            <ix-icon name="ix:logo_truenas_scale_mark"></ix-icon>
          </div>
          <div class="screenshot">
            <img
              alt="Logo image background of stars and sky at night"
              class="screenshot-image"
              src="assets/images/stars-sky-1200w.jpg"
              srcset="assets/images/stars-sky-400w.jpg, assets/images/stars-sky-800w.jpg 2x, assets/images/stars-sky-1200w.jpg 3x">
            <ix-icon name="ix:logo_truenas_scale_mark"></ix-icon>
          </div>
          <div class="screenshot">
            <img
              alt="Logo image background of stars and sky at night"
              class="screenshot-image"
              src="assets/images/stars-sky-1200w.jpg"
              srcset="assets/images/stars-sky-400w.jpg, assets/images/stars-sky-800w.jpg 2x, assets/images/stars-sky-1200w.jpg 3x">
            <ix-icon name="ix:logo_truenas_scale_mark"></ix-icon>
          </div>
        </ng-template>
      </div>
    </section>

    <!-- TODO: https://ixsystems.atlassian.net/browse/NAS-121706 -->
    <section>
      <h2>{{ 'Similar Apps' | translate }}</h2>

      <div *ngIf="similarAppsLoading$ | async; else similarAppsTemplate" fxLayout="row wrap" fxLayoutGap="16px">
        <ngx-skeleton-loader class="similar-app-loader" fxFlex></ngx-skeleton-loader>
        <ngx-skeleton-loader class="similar-app-loader" fxFlex></ngx-skeleton-loader>
      </div>

      <ng-template #similarAppsTemplate>
        <div *ngIf="similarApps.length; else emptySimilarApps" class="similar-apps">
          <ix-app-card
            *ngFor="let app of similarApps; trackBy: trackByAppId"
            [app]="app"
            [routerLink]="['/apps', 'available', app.catalog, app.train, app.name]"
          ></ix-app-card>

        </div>
      </ng-template>

      <ng-template #emptySimilarApps>
        <h4>{{ 'No apps are found.' | translate }}</h4>
      </ng-template>
    </section>
  </div>

  <div fxFlex fxLayoutAlign="end">
    <section class="app-info-cards">
      <ix-app-resources-card [isLoading$]="isLoading$"></ix-app-resources-card>
      <ix-app-helm-chart-card [app]="app" [isLoading$]="isLoading$"></ix-app-helm-chart-card>
      <ix-app-available-info-card [app]="app" [isLoading$]="isLoading$"></ix-app-available-info-card>
    </section>
  </div>
</div>
