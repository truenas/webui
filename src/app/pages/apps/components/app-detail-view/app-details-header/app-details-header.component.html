<div class="app" fxFlex="200px">
  @if (app?.installed) {
    <a
      class="installed-badge"
      [matTooltip]="'An instance of this app already installed. Click the badge to see installed apps.' | translate"
      [ixTest]="[app?.name, 'installed-badge']"
      (click)="navigateToAllInstalledPage()"
    >
      {{ 'Installed' | translate }}
    </a>
  }
  <div class="app-image-holder">
    <ix-app-card-logo [url]="app?.icon_url"></ix-app-card-logo>
  </div>
  @if (!!(kubernetesStore.selectedPool$ | async)) {
    <button
      *ixRequiresRoles="requiredRoles"
      mat-button
      color="primary"
      [ixTest]="[app?.name, 'install']"
      [disabled]="!app"
      (click)="navigateToInstallPage()"
    >
      @if (app?.installed) {
        {{ 'Install Another Instance' | translate }}
      } @else {
        {{ 'Install' | translate }}
      }
    </button>
  } @else {
    <button
      *ixRequiresRoles="requiredRoles"
      mat-button
      color="primary"
      ixTest="setup-pool"
      (click)="showChoosePoolModal()"
    >
      {{ 'Setup Pool To Install' | translate }}
    </button>
  }
</div>

<div class="app-info" fxFlex="240px">
  <div class="app-list-item">
    <span class="label">{{ 'App Version' | translate }}:</span>
    <ngx-skeleton-loader *ngIf="isLoading$ | async; else latestAppVersion"></ngx-skeleton-loader>
    <ng-template #latestAppVersion>
      <ng-container *ngIf="app?.latest_app_version; else notAvailable">
        {{ app?.latest_app_version }}
      </ng-container>
    </ng-template>
  </div>
  <div class="app-list-item">
    <span class="label">{{ 'Keywords' | translate }}:</span>
    <ngx-skeleton-loader *ngIf="isLoading$ | async; else appCategories"></ngx-skeleton-loader>
    <ng-template #appCategories>
      <ng-container *ngIf="app?.tags; else notAvailable">
        {{ app?.tags.join(', ') }}
      </ng-container>
    </ng-template>
  </div>
  <div class="app-list-item">
    <span class="label">{{ 'Train' | translate }}:</span>
    <ngx-skeleton-loader *ngIf="isLoading$ | async; else train"></ngx-skeleton-loader>
    <ng-template #train>
      <ng-container *ngIf="app?.train; else notAvailable">
        {{ app?.train }}
      </ng-container>
    </ng-template>
  </div>
  <!-- TODO: https://ixsystems.atlassian.net/browse/NAS-121706 -->
  <div class="app-list-item">
    <span class="label">{{ 'Homepage' | translate }}:</span>
    <ngx-skeleton-loader *ngIf="isLoading$ | async; else homepage"></ngx-skeleton-loader>
    <ng-template #homepage>
      <ng-container *ngIf="app?.home; else notAvailable">
        <a
          ixTest="homepage"
          target="_blank"
          [href]="app.home"
          [title]="app.home"
        >{{ app.home | cleanLink }}</a>
      </ng-container>
    </ng-template>
  </div>
</div>

<div class="app-description">
  @if (isLoading$ | async) {
    <ngx-skeleton-loader count="2"></ngx-skeleton-loader>
  } @else if (description) {
    <div class="description-wrapper">{{ description }}</div>
  }
</div>

<ng-template #notAvailable>
  {{ 'N/A' | translate }}
</ng-template>
