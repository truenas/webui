<form [formGroup]="form">
  <ix-fieldset [title]="'Authentication' | translate">
    @if (isStigMode() && !editingUser()) {
      <ix-radio-group
        formControlName="stig_password"
        [label]="'Password' | translate"
        [required]="true"
        [options]="stigPasswordOptions$"
      ></ix-radio-group>
    } @else {
      <ix-input
        class="password-input"
        formControlName="password"
        type="password"
        autocomplete="new-password"
        [label]="!editingUser() ? ('Password' | translate) : ('Change Password' | translate)"
        [tooltip]="(!editingUser() ? tooltips.password : tooltips.password_edit) | translate"
        [required]="!editingUser()"
      ></ix-input>

      @if (!editingUser() || (editingUser() && form.controls.password.value)) {
        <ix-input
          class="password-input"
          formControlName="password_confirm"
          type="password"
          autocomplete="new-password"
          [label]="'Confirm Password' | translate"
          [tooltip]="tooltips.password_confirm | translate"
          [required]="!editingUser() || !!form.controls.password.value"
        ></ix-input>
      }

      @if (!smbAccess()) {
        <ix-checkbox
          formControlName="password_disabled"
          [label]="'Disable Password' | translate"
          [tooltip]="tooltips.password_disabled | translate"
        ></ix-checkbox>
      }
    }

    @if (sshAccess()) {
      <ix-checkbox
        formControlName="ssh_password_enabled"
        [label]="'Allow SSH Login with Password (not recommended)' | translate"
      ></ix-checkbox>

      @if (form.hasError('ssh_password_enabled')) {
        <div class="ssh-access-error">
          {{ form.getError('ssh_password_enabled')?.message | translate }}
        </div>
      }

      <ix-textarea
        formControlName="sshpubkey"
        class="key-textarea"
        [label]="'Public SSH Key' | translate"
        [tooltip]="tooltips.sshpubkey | translate"
      ></ix-textarea>

      @if (form.hasError('sshAccessRequired')) {
        <div class="ssh-access-error">
          {{ form.getError('sshAccessRequired')?.message | translate }}
        </div>
      }
    }
  </ix-fieldset>
</form>
