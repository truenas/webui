<ng-template #pageHeader>
  <ix-page-title-header>
    <button (click)="onSubmit()" color="primary" mat-button>
      {{ 'Save' | translate }}
    </button>
    <button mat-button [matMenuTriggerFor]="categoriesMenu">
      {{ 'Category' | translate }}
      <mat-icon>arrow_drop_down</mat-icon>
    </button>
    <mat-menu #categoriesMenu="matMenu">
      <button
        *ngFor="let category of categories; let i = index"
        mat-menu-item
        (click)="onCategoryChanged(category.id)"
      > {{ category.title }} </button>
    </mat-menu>
  </ix-page-title-header>
</ng-template>

<mat-card class="form-card">
  <div class="mat-content">
    <ng-container *ngFor="let category of categories">
      <ix-fieldset [title]="category.title" *ngIf="selectedCategory === category.id">
        <ng-container *ngFor="let cls of category.classes">
          <div [formGroup]="form.controls[cls.id]" class="class-row">
            <span class="class-label">{{ cls.title }}</span>
            <ix-select
              formControlName="level"
              [label]="'Set Warning Level' | translate"
              [required]="true"
              [tooltip]="helptext.level_tooltip | translate"
              [options]="levelOptions$"
            ></ix-select>
            <ix-select
              formControlName="policy"
              [label]="'Set Frequency' | translate"
              [required]="true"
              [tooltip]="helptext.policy_tooltip | translate"
              [options]="policyOptions$"
            ></ix-select>
          </div>
        </ng-container>
      </ix-fieldset>
    </ng-container>
  </div>
</mat-card>
